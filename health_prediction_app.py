import streamlit as st
import numpy as np
import matplotlib.pyplot as plt
import json

intercept = 4.5729182157694765

contributions = [np.array([-0.11555167,  0.10630754]),
 np.array([ 0.73172979,  0.7169753 ,  0.65991391,  0.58462491,  0.42943088,
         0.37238195,  0.29974762,  0.25338688,  0.22943497,  0.20045914,
         0.16602402,  0.106857  ,  0.09103516,  0.07681874,  0.04775482,
         0.04224866,  0.04207907,  0.03644773, -0.04326588, -0.14888822,
        -0.17084043, -0.1619126 , -0.16572536, -0.18094366, -0.21863281,
        -0.26875356, -0.33181845, -0.34338791, -0.40754484, -0.48891676,
        -0.54291283, -0.548133  , -0.42206399, -0.36603514, -0.22925144]),
 np.array([-0.92786086, -0.90656124, -0.86492264, -0.82513806, -0.78186143,
        -0.73892786, -0.68660445, -0.65090407, -0.63483297, -0.61643881,
        -0.58548935, -0.54506321, -0.50116007, -0.49271543, -0.48068271,
        -0.47049572, -0.45178563, -0.44805539, -0.43834947, -0.42611313,
        -0.41876503, -0.40342973, -0.39294047, -0.37824863, -0.35369974,
        -0.33405623, -0.30930103, -0.29277221, -0.29624839, -0.28570611,
        -0.25569042, -0.24841743, -0.23564521, -0.22242514, -0.21224397,
        -0.20403788, -0.21463569, -0.20167713, -0.18562774, -0.17207775,
        -0.16009528, -0.14834629, -0.11503804,  0.19441325,  0.2230249 ,
         0.23821286,  0.25218183,  0.26379232,  0.27692583,  0.29150182,
         0.30093901,  0.30587997,  0.30765597,  0.30092458,  0.29923235,
         0.29375636,  0.17398753,  0.17693135,  0.19176054,  0.19958754,
         0.20475772,  0.21458023,  0.2232932 ,  0.22017083,  0.22257812,
         0.23639883,  0.24417841,  0.23471552,  0.21838682,  0.20135664,
         0.1656248 ,  0.0032346 ,  0.00386954,  0.00100241, -0.00634548,
        -0.00965436,  0.00170348,  0.00908969,  0.0415733 ,  0.06442153,
         0.09626762,  0.1183791 ,  0.14885814,  0.18016856,  0.20646739,
         0.22906125,  0.26423392,  0.29396952,  0.33652067,  0.36837972,
         0.40615494,  0.43969685,  0.48216066,  0.51002354,  0.54141469,
         0.56815917,  0.59538821,  0.62179383,  0.65559053,  0.68802857,
         0.71978798,  0.73765008,  0.76189747,  0.77932712]),
 np.array([-1.20459854, -1.4448852 , -1.44076984, -1.36385179, -1.14802629,
        -0.63961452, -0.52677045, -0.44651043, -0.41255594,  0.31475185,
         0.63330558,  0.82158059,  0.99779001,  1.147061  ,  1.28745936,
         1.41359802,  1.52974825,  1.62406482,  1.70173454,  1.78146484,
         1.76721182]),
 np.array([ 0.7706595 ,  0.73094492,  0.69607369,  0.66517231,  0.62103429,
         0.58127423,  0.54283923,  0.4991904 ,  0.46876207,  0.43139467,
         0.37730208,  0.32223134,  0.26632705,  0.25569101,  0.27437597,
         0.27711724,  0.2768554 ,  0.27004573,  0.2785307 ,  0.28279793,
         0.27436471,  0.26768524,  0.25415168,  0.23490088,  0.22726704,
         0.19973159,  0.20487792,  0.20765587,  0.24583717,  0.25113938,
         0.24330685,  0.23146151,  0.21296133,  0.14816358,  0.13537691,
         0.12090415,  0.10529035,  0.08758291,  0.08501109,  0.08039025,
         0.08555005,  0.08479463,  0.075203  ,  0.0713575 ,  0.06771881,
         0.03913185,  0.01055778, -0.04455093, -0.06657318, -0.08430146,
        -0.10044855, -0.12856688, -0.18155033, -0.21356303, -0.22764467,
        -0.23576331, -0.2548254 , -0.27509383, -0.28804118, -0.30352395,
        -0.26723627, -0.28014126, -0.27899042, -0.30235115, -0.31401029,
        -0.32539357, -0.34676694, -0.35788836, -0.36396799, -0.37595253,
        -0.40678067, -0.42567353, -0.43545788, -0.44312198, -0.44671216,
        -0.45368257, -0.48456658, -0.50373475, -0.56304952, -0.5928809 ,
        -0.63717579, -0.67474725, -0.71646365, -0.7513418 ]),
 np.array([ 0.28625714,  0.11964028,  0.04280597,  0.00435734, -0.03929273,
        -0.02583145, -0.0432355 ,  0.15346921,  0.08797297,  0.05055442,
        -0.02052146, -0.09748758, -0.10841831, -0.12639784, -0.03727694,
        -0.05235579, -0.08199652, -0.12501455, -0.02219313, -0.03158506,
        -0.10269606, -0.11895554,  0.04392215,  0.1944394 ]),
 np.array([ 0.18499282,  0.15899113,  0.11878588,  0.07442301,  0.22188733,
         0.24999054,  0.27452041,  0.28684698,  0.30486487,  0.32259682,
         0.3332902 ,  0.34663931,  0.3496616 ,  0.37107132,  0.39328458,
         0.40540489,  0.39022053,  0.36468694,  0.335533  ,  0.33003173,
         0.31720101,  0.30405059,  0.28377749,  0.26416006,  0.24377674,
         0.0940648 ,  0.11609381,  0.1057399 ,  0.08317528,  0.07065895,
         0.06797679,  0.05451167,  0.03035466,  0.01426023,  0.01332526,
         0.02317763,  0.02497307,  0.02609239,  0.02404051,  0.0268873 ,
         0.02925151,  0.02928258,  0.02560247,  0.03345643,  0.03177348,
         0.03746745,  0.04667297,  0.0479302 ,  0.05360565,  0.05416392,
         0.0459614 ,  0.03877781,  0.03141954,  0.01601174,  0.00230881,
        -0.01605662, -0.02804081, -0.03893913, -0.06433701, -0.0832481 ,
        -0.0939507 , -0.09088345, -0.10354525, -0.10916731, -0.1269323 ,
        -0.12553821, -0.13655902, -0.14429652, -0.15431746, -0.15871046,
        -0.15543334, -0.15741752, -0.16758871, -0.18054606, -0.18713033,
        -0.19224269, -0.19580605, -0.21431771, -0.23403971, -0.24863649,
        -0.26313116, -0.29404559, -0.31755135, -0.34541382, -0.37207394,
        -0.38566333, -0.39583033, -0.40231848, -0.39510525, -0.43026833,
        -0.516962  , -0.56769992, -0.60854489, -0.64326715, -0.67822975]),
 np.array([-9.87537151e-02, -1.35333939e-01, -1.21401071e-01, -8.99998062e-02,
        -7.35602992e-02, -6.97550636e-02, -6.30429684e-02, -7.04664717e-02,
        -6.48686370e-02, -6.11773362e-02, -5.51563302e-02, -4.21526276e-02,
        -3.38144316e-02, -2.78455844e-02, -2.64132298e-02, -2.66818514e-02,
        -1.99692234e-02, -9.61477769e-03,  1.25776234e-04,  1.76062687e-03,
         1.36777695e-02,  1.85650527e-02,  2.82588288e-02,  3.54121633e-02,
         4.21205445e-02,  4.57736773e-02,  3.63911945e-02,  2.84586860e-02,
         2.93053953e-02,  3.85347779e-02,  4.31216703e-02,  6.30105935e-02,
         7.60895399e-02,  8.55951174e-02,  9.17918366e-02,  1.06238179e-01,
         1.11682227e-01,  1.12994626e-01,  1.24726780e-01,  1.33394859e-01,
         1.43284400e-01,  1.48408038e-01,  1.47550568e-01,  1.65009133e-01,
         1.77948638e-01,  1.87508213e-01,  2.07298701e-01,  2.17203884e-01,
         2.22599811e-01,  2.24001281e-01,  2.26069526e-01,  2.20140260e-01,
         2.17249337e-01,  2.12044083e-01,  2.06124656e-01,  2.00542332e-01,
         1.88498876e-01,  1.75624147e-01,  1.35537602e-01,  1.27811492e-01,
         1.18553943e-01,  1.05458512e-01,  9.41540783e-02,  8.24395875e-02,
         7.13717916e-02,  7.01286017e-02,  6.50178748e-02,  5.59414802e-02,
         4.10950751e-02,  1.02164481e-02, -4.03305029e-03, -1.49912827e-02,
        -1.76726134e-02, -1.99042639e-02, -2.41671377e-02, -2.89724361e-02,
        -3.06915769e-02, -3.38667387e-02, -3.87937100e-02, -4.38833321e-02,
        -4.87665030e-02, -5.38798788e-02, -5.58605366e-02, -4.74619061e-02,
        -3.65864851e-02,  4.42862953e-02,  5.95836256e-02,  7.07754091e-02,
         8.13583388e-02,  7.93673104e-02,  8.18816650e-02,  7.62072797e-02,
         6.39186723e-02,  6.00761124e-02,  5.32929790e-02,  4.81234155e-02,
         4.19581931e-02,  4.00966836e-02,  4.14855341e-02,  4.04269421e-02,
         3.73224570e-02,  3.30087088e-02,  2.40052972e-02,  1.78974661e-02,
         7.06814517e-03, -5.09291952e-03, -2.40243700e-02, -3.41450965e-02,
        -3.66562632e-02, -4.75169401e-02, -5.94795987e-02, -8.19008857e-02,
        -1.08706086e-01, -1.46228674e-01, -1.81875432e-01, -3.25261275e-01,
        -3.50503620e-01, -3.58396868e-01, -3.66903673e-01, -3.81230004e-01,
        -4.10399185e-01, -4.46436748e-01, -4.72178569e-01, -4.93814069e-01,
        -4.66117496e-01, -4.35739914e-01, -4.07262563e-01]),
 np.array([ 0.29988568,  0.30887641,  0.27034551,  0.24275556,  0.18411795,
         0.19789934,  0.18632412,  0.1879488 ,  0.16168005,  0.14989317,
         0.14655361,  0.13842439,  0.18371228,  0.19632803,  0.19177096,
        -0.05225983, -0.13018942, -0.289101  , -0.3304805 , -0.36576427,
        -0.39818899, -0.41309326, -0.41184937, -0.40554487, -0.37288104,
        -0.03061291,  0.0543608 ,  0.02803658, -0.03147692, -0.11010042,
         0.0213623 ,  0.16541481,  0.27448113,  0.37836627,  0.43975867]),
 np.array([-0.91789961, -0.81832193, -0.69562227, -0.58344574, -0.46519847,
        -0.04010389,  0.05380048,  0.06526265,  0.05774642, -0.04074109,
        -0.14725284, -0.16088582, -0.14308721, -0.1371736 , -0.10077232,
        -0.04725239, -0.01987221, -0.00270852,  0.02319335,  0.03236481,
         0.04031947,  0.02572291,  0.03135898,  0.03375558,  0.01975585,
         0.0128531 ,  0.0604337 ,  0.14025959,  0.17786257,  0.18035652,
         0.1853358 ,  0.15723291,  0.10606712,  0.21147125,  0.31583443,
         0.40907666,  0.49341023,  0.57281119,  0.64865185,  0.71402719,
         0.74768197]),
 np.array([-0.62878496, -0.50322616, -0.4203108 , -0.34226823, -0.29144676,
        -0.26398607, -0.13360428, -0.18617788, -0.15098494, -0.10719885,
        -0.07268205, -0.06537967, -0.03366234, -0.03303185, -0.05423823,
         0.00329212,  0.0158756 ,  0.09330565,  0.14127586,  0.16469281,
         0.16330543,  0.18817457,  0.18681542,  0.14988292,  0.12013131,
         0.22800991,  0.35022253,  0.47017255,  0.57163738,  0.6644468 ,
         0.73754379,  0.80984786,  0.88079528,  0.94840675,  0.95664931]),
 np.array([-0.67970047, -0.61292863, -0.50091284, -0.38497647, -0.24495987,
        -0.2035569 , -0.16307668, -0.1357275 , -0.11884318, -0.13365429,
        -0.13188069, -0.13915388, -0.15325517, -0.14102434, -0.16073909,
        -0.17299229, -0.1454469 , -0.11683683, -0.06995619, -0.04182362,
         0.13813853,  0.19011245,  0.233637  ,  0.20880744,  0.26370714,
         0.26558632,  0.20665734,  0.2059107 ,  0.31602337,  0.40640741,
         0.51386312,  0.59456669,  0.69137892,  0.76910729,  0.8281418 ,
         0.89567039,  0.9586444 ]),
 np.array([-0.96520465, -0.93730208, -1.14879332, -1.16152646, -1.16322877,
        -1.16585612, -1.16265921, -1.14867447, -1.13495389, -1.15260845,
        -1.14998213, -1.14092551, -1.13418084, -1.13102824, -1.11925621,
        -1.10087769, -1.07803936, -1.05921676, -1.03942113, -1.0138565 ,
        -0.9936235 , -0.96552195, -0.940966  , -0.91400083, -0.87016148,
        -0.84551212, -0.81111751, -0.72972772, -0.54544996, -0.51202769,
        -0.25521234, -0.21657144, -0.18884349, -0.07647721, -0.04601881,
        -0.02537263, -0.00891755,  0.00151911,  0.01089071, -0.15401308,
        -0.14592316, -0.12664906, -0.12353256, -0.11373931, -0.10897875,
        -0.09501025, -0.08110016, -0.0776261 , -0.06858454, -0.05218102,
         0.04694793,  0.05589841,  0.07196181,  0.08824686,  0.09299251,
         0.10356511,  0.11368998,  0.13094935,  0.14123601,  0.16027897,
         0.1752727 ,  0.19295184,  0.21879863,  0.23624658,  0.24938113,
         0.25883509,  0.26989701,  0.28192046,  0.2963451 ,  0.29373008,
         0.30741929,  0.31523055,  0.31735344,  0.31711833,  0.3164093 ,
         0.2324854 ,  0.23839174,  0.24261036,  0.25377824,  0.26929437,
         0.28622372,  0.30801531,  0.32087772,  0.32988077,  0.33452104,
         0.33988864,  0.34366726,  0.34418482,  0.36020283,  0.37509656,
         0.37947614,  0.38666875,  0.39405341,  0.39695799,  0.40004349,
         0.39888732,  0.39834348,  0.39558956,  0.38960855,  0.37944905,
         0.36737107,  0.35436517,  0.34138111,  0.3432683 ,  0.34050389,
         0.33942351,  0.33970708,  0.33660629,  0.33377816,  0.3252416 ,
         0.31423956,  0.30330714,  0.32958871,  0.3583018 ,  0.39270978,
         0.41794166,  0.4391825 ,  0.47259596,  0.49692978,  0.51982138,
         0.53668248,  0.56327589,  0.58609479,  0.60503346,  0.63152878,
         0.64939648,  0.67823186,  0.69941557,  0.71974544,  0.73806798,
         0.75409639,  0.77730128,  0.79334416]),
 np.array([-2.36448287, -2.33505131, -2.30872216, -2.26761729, -2.24073845,
        -2.20948356, -2.18098323, -2.1439376 , -2.11176244, -2.08350293,
        -2.03852467, -2.00386217, -1.94956062, -1.9047779 , -1.86209521,
        -1.81490497, -1.76239117, -1.73184532, -1.69318628, -1.65579857,
        -1.59222262, -1.58374456, -1.56199373, -1.52049248, -1.48412389,
        -1.4463709 , -1.39588219, -1.44555088, -1.40776747, -1.34446543,
        -0.48328458, -0.42677069, -0.38691921, -0.52146846, -0.60850527,
        -0.59229208, -0.5572921 , -0.51123995, -0.46776786, -0.05132089,
         0.01328753,  0.06655897,  0.11178578,  0.14938455,  0.1868845 ,
         0.21399648,  0.2305654 ,  0.27990861,  0.31544608,  0.34109563,
         0.378902  ,  0.45185786,  0.49677547,  0.52448746,  0.5551383 ,
         0.58424818,  0.68694678,  0.7172321 ,  0.74334294,  0.75496099,
         0.78937169,  0.80792597,  0.83084047,  0.84405639,  0.86295176,
         0.88047999,  0.89911678,  0.91209205,  0.92582546,  0.92785876,
         0.85594052,  0.88462947,  0.92807256,  0.95418722,  0.98385232,
         1.01697593,  1.04490681,  1.07423832,  1.10803395,  1.12927645,
         1.15330802,  1.187051  ,  1.21081315,  1.23277014,  1.2589217 ,
         1.28427188,  1.30283178,  1.3308338 ,  1.35232612,  1.37194149,
         1.39101542,  1.41493325,  1.43924024,  1.45450128,  1.47370806,
         1.4881752 ,  1.50840481,  1.52261047,  1.53941769,  1.55404201,
         1.56491605,  1.5787339 ,  1.5937509 ,  1.6056238 ,  1.61469536,
         1.63346822]),
 np.array([-2.69308589e+00, -2.66532418e+00, -2.63694954e+00, -2.60324549e+00,
        -2.56991250e+00, -2.53561380e+00, -2.50786729e+00, -2.45995600e+00,
        -2.41745341e+00, -2.37719483e+00, -2.34528173e+00, -2.29764922e+00,
        -2.25335228e+00, -2.21274335e+00, -2.17277210e+00, -2.11716730e+00,
        -2.06808941e+00, -2.00134084e+00, -1.93959619e+00, -1.88524669e+00,
        -1.81955468e+00,  6.23227212e-02,  9.90099026e-02,  1.39434422e-01,
         1.86451616e-01,  2.14597045e-01,  2.36523026e-01, -4.34949043e-01,
        -4.34445998e-01, -4.31347354e-01, -4.19359124e-01, -4.08215350e-01,
        -3.95648575e-01, -3.67168174e-01, -3.49847242e-01, -3.10712498e-01,
        -2.88610084e-01, -2.65280296e-01, -2.37793355e-01, -2.20778363e-01,
        -2.07298071e-01, -1.83519993e-01, -1.63872293e-01, -1.50772296e-01,
        -1.38682757e-01, -1.31614304e-01, -1.22755339e-01, -1.19100245e-01,
        -1.28342157e-01, -1.10880159e-01, -1.03724844e-01, -8.30070832e-02,
        -6.48490483e-02, -4.09222190e-02, -2.42855702e-02, -2.96997938e-04,
         2.83866631e-02,  9.84988431e-02,  1.28465811e-01,  1.63450027e-01,
         1.90620975e-01,  2.19855065e-01,  2.34587423e-01,  2.69227882e-01,
         2.84507486e-01,  4.03105719e-01,  4.31259780e-01,  8.37330389e-01,
         8.83878975e-01,  9.39245033e-01,  9.81046716e-01,  1.02406984e+00,
         1.06675799e+00,  1.10682814e+00,  1.13943454e+00,  1.16859457e+00,
         1.20080190e+00,  1.23179949e+00,  1.26308391e+00,  1.30113848e+00,
         1.33510359e+00,  1.36028873e+00,  1.39234978e+00,  1.42080135e+00,
         1.45679790e+00,  1.47521777e+00,  1.50115117e+00,  1.52846880e+00,
         1.54906534e+00,  1.57885829e+00,  1.59973432e+00,  1.62449645e+00,
         1.64359170e+00,  1.66271750e+00,  1.68323756e+00,  1.69721070e+00,
         1.71818127e+00,  1.73228430e+00,  1.75318705e+00,  1.77496356e+00]),
 np.array([-1.45232449, -1.43254774, -1.37805663, -1.31018274, -1.24137772,
        -1.17794046, -1.12273128, -1.09605913, -1.06520355, -1.02550893,
        -0.97870378, -0.90970516, -0.90939558, -0.88184197, -0.85552627,
        -0.82125127, -0.82887233, -0.80078791, -0.77972606, -0.77255122,
        -0.77137685, -0.7387832 , -0.11248531, -0.06188299, -0.01943549,
         0.02461836,  0.09001008,  0.12681083,  0.15378951,  0.19107091,
         0.22707685,  0.26212873,  0.30378218,  0.33045418,  0.34991775,
         0.377017  ,  0.3976881 ,  0.41774229,  0.44964014,  0.4685554 ,
         0.49009415,  0.50916281,  0.52726315,  0.54570624,  0.55459293,
         0.56536324,  0.56676672,  0.53513591,  0.30541054,  0.3024295 ,
         0.31620752,  0.31609702,  0.30640379,  0.31442446,  0.32183506,
         0.31579117,  0.30769598,  0.31124226,  0.35067965,  0.42926576,
         0.47390371,  0.52065482,  0.56627975,  0.60807082,  0.64719848,
         0.67954818,  0.71907261,  0.76191531,  0.80648782,  0.83825874,
         0.87484971,  0.9138127 ,  0.94531686,  0.97840231,  1.0170842 ,
         1.05313022,  1.0906445 ,  1.12532904,  1.15790234,  1.18313019,
         1.21248536,  1.23814527,  1.2662903 ,  1.27261597]),
 np.array([-0.20027316, -0.1231627 , -0.07271166, -0.04250982, -0.04557844,
        -0.05570465, -0.03535173, -0.05065699, -0.05353544, -0.13934988,
        -0.13479397, -0.14770704, -0.19250591, -0.21241916, -0.23043395,
        -0.22731583, -0.21810106, -0.20703766, -0.2131672 , -0.23115958,
        -0.23176577, -0.2321786 , -0.2348702 , -0.22202294, -0.21807726,
        -0.21873088, -0.27743069, -0.26682625, -0.25436268, -0.08314291,
        -0.02012751,  0.01452604,  0.04314538,  0.05511508,  0.07384797,
         0.09968831,  0.11876706,  0.13343667,  0.12902059,  0.12151434,
         0.10698439,  0.0637306 ,  0.0597762 ,  0.06062391,  0.07634971,
         0.08471724,  0.08596095,  0.08955942,  0.08819562,  0.10566678,
         0.10171353,  0.03382023,  0.03172274,  0.02245024,  0.07852496,
         0.12660446,  0.1642888 ,  0.26395568,  0.32008683,  0.3856333 ,
         0.45584553,  0.50609505,  0.57162946,  0.62908842,  0.67598671,
         0.72967371,  0.77771365,  0.81569653,  0.84544791]),
 np.array([-0.27150145, -0.31603687, -0.34555461, -0.34473269, -0.34313475,
        -0.31017725, -0.2758398 , -0.26204662, -0.26912779, -0.27936344,
        -0.28279428, -0.273394  , -0.32056909, -0.32963386, -0.33310889,
        -0.34811752, -0.36872376, -0.35707286, -0.35400489, -0.33821077,
        -0.32232253, -0.30233835, -0.27139255, -0.243821  , -0.22711393,
        -0.19316829, -0.15616309, -0.12818369, -0.10574472,  0.08987747,
         0.15176989,  0.19761999,  0.23082583,  0.25607503,  0.29194403,
         0.31849186,  0.33878402,  0.35023117,  0.28771161,  0.27743783,
         0.25192402,  0.25326434,  0.2458358 ,  0.23265406,  0.21498405,
         0.20485717,  0.19340799,  0.18121449,  0.18321829,  0.1707161 ,
         0.17455267,  0.17074185,  0.17758908,  0.18505251,  0.1861389 ,
         0.18356247,  0.17010266,  0.1121983 ,  0.03641511,  0.00986945,
        -0.00273509, -0.01545456, -0.0309636 , -0.04473024, -0.06568597,
        -0.08128657, -0.09756259, -0.12695211, -0.13358009, -0.16602545,
        -0.10105573, -0.04842861, -0.0057252 ,  0.03676514,  0.08312834,
         0.13186787,  0.18832314,  0.20696327]),
 np.array([ 0.30039809,  0.35267228,  0.34010221,  0.32016881,  0.30426718,
         0.2877614 ,  0.27657314,  0.2566989 ,  0.17589597,  0.15156045,
         0.13805442,  0.12594748,  0.10430929,  0.09423183,  0.09268653,
         0.12179284,  0.11758074,  0.12406516,  0.1541494 ,  0.16279948,
         0.17271571,  0.17967004,  0.19029236,  0.18070881,  0.18074177,
         0.19289638,  0.18962411,  0.19319893,  0.1880386 ,  0.18605665,
         0.1601767 ,  0.13652007,  0.09251134,  0.06920981,  0.04620486,
         0.01187165, -0.0225783 , -0.05044447, -0.0737404 , -0.1491241 ,
        -0.17050807, -0.18185392, -0.19484465, -0.21733858, -0.23035857,
        -0.25486115, -0.27264451, -0.30887071, -0.31218664, -0.31863303,
        -0.32804349, -0.3364197 , -0.35566341, -0.37796565, -0.37756489,
        -0.36401909, -0.31005473, -0.29328278, -0.29143991, -0.28634336,
        -0.30417745, -0.30897259, -0.33901157, -0.31430748, -0.30659775,
        -0.28206582, -0.26571267, -0.23428973, -0.19093338, -0.1468066 ,
        -0.10649935, -0.08623033, -0.08661621, -0.09477492, -0.105629  ,
        -0.05320354, -0.00532509,  0.04972189,  0.11181535,  0.16734284]),
 np.array([ 0.83552177,  0.76465483,  0.69612275,  0.63053836,  0.54956582,
         0.48127018,  0.4010986 ,  0.32365978,  0.2378566 ,  0.10770261,
         0.13112863,  0.15039957,  0.133169  ,  0.08374515, -0.02577918,
        -0.04350335, -0.06933777, -0.10825499, -0.15780404, -0.16966944,
        -0.18627224, -0.20755156, -0.20079124, -0.201991  , -0.15398988,
        -0.09973449, -0.07875664, -0.08690911, -0.09590275, -0.09169066,
        -0.09563746, -0.09410879, -0.10320697, -0.09547123, -0.07289798,
        -0.03778314, -0.00659236,  0.0419723 ,  0.07385678,  0.09158475,
         0.11035321,  0.10454035,  0.09379669,  0.02779269, -0.00858513,
        -0.05447207, -0.07633601, -0.08836216, -0.06776897, -0.01713125,
        -0.06041836, -0.13227293, -0.20051957]),
 np.array([ 0.21548169,  0.26708   ,  0.2324705 ,  0.19818176,  0.14351868,
         0.12524125, -0.02454028, -0.13238989, -0.04903589, -0.04653009,
        -0.08013309, -0.08661121, -0.09886622, -0.10256047, -0.1024294 ,
        -0.10417967, -0.0950625 , -0.08422236, -0.08324434, -0.07185949,
        -0.0708748 , -0.07207162, -0.07427679, -0.08084684, -0.09407081,
        -0.09436731, -0.088216  , -0.09090561, -0.09844663, -0.11505478,
        -0.14983675, -0.17193666, -0.17145071, -0.18325021, -0.18583892,
        -0.15913795, -0.15242647, -0.152195  , -0.16442841, -0.16747779,
        -0.15961691, -0.16309317, -0.17057001, -0.15928871, -0.15712945,
        -0.15244217, -0.13669203, -0.12229105, -0.11363286, -0.07839877,
        -0.064836  , -0.0493808 , -0.03538112, -0.04183488, -0.06132349,
        -0.07402062, -0.07417883, -0.05853559, -0.03713361, -0.01058653,
         0.01752257,  0.09447028,  0.15892734,  0.21762999,  0.28619488,
         0.33000223,  0.37278944,  0.42467411,  0.47196541,  0.52498168,
         0.57824582,  0.62973923,  0.68066272,  0.72006015,  0.76806683,
         0.81773058,  0.85227754]),
 np.array([ 2.09078740e-01,  1.70447880e-01,  1.27379220e-01,  1.33608587e-01,
         1.61519956e-01,  1.58870310e-01,  1.44180955e-01,  1.14291844e-01,
         9.86431156e-02,  9.13707596e-02,  7.15554344e-02,  5.85261662e-02,
         3.53345362e-02,  1.98648170e-02,  1.85527111e-02,  7.40060344e-03,
         9.24392034e-03,  3.93967266e-03, -1.26431964e-03, -9.75102977e-03,
        -2.30350344e-02, -9.00435174e-02, -9.95809961e-02, -4.65657932e-02,
        -3.30944511e-02, -2.62662965e-02, -1.75335484e-02, -1.39080497e-02,
         1.36620786e-02,  2.86083030e-02,  5.90917600e-02,  5.03988010e-02,
         3.94005537e-02,  5.36078845e-02,  6.68224427e-02,  8.31878453e-02,
         9.94708262e-02,  1.10010270e-01,  1.17782306e-01,  1.21158586e-01,
         1.20355422e-01,  1.24670482e-01,  1.17512505e-01,  1.06910339e-01,
         1.01532987e-01,  8.00925795e-02,  4.23006520e-02,  2.09428327e-02,
        -4.26891526e-03, -6.75873982e-03, -1.35817249e-02,  1.30175189e-04,
         6.74574986e-03,  5.64506996e-03,  1.72026095e-03, -6.71431340e-03,
        -1.88158328e-02, -3.86766047e-02, -5.89365446e-02, -5.67393728e-02,
        -6.56995234e-02, -8.51129013e-02, -8.87892844e-02, -1.06832109e-01,
        -7.29657764e-02, -6.04715022e-02, -4.56094474e-02, -4.05527502e-02,
        -3.84575511e-02, -3.86926920e-02, -3.66512249e-02, -4.18660438e-02,
        -5.67264170e-02, -7.21774290e-02, -9.42015759e-02, -1.34046095e-01,
        -1.42903216e-01, -1.52815380e-01, -1.65137259e-01, -2.06198104e-01,
        -2.47889545e-01, -2.85103656e-01, -3.82190851e-01, -4.29537583e-01]),
 np.array([-0.31016969, -0.2868013 , -0.22009403, -0.19856922, -0.22193528,
        -0.21800854, -0.20583947, -0.21195356, -0.24097165, -0.24942857,
        -0.23586793, -0.21420069, -0.17195624, -0.14796081, -0.12206752,
        -0.10390682, -0.09048656, -0.05167502,  0.04753578,  0.11664938,
         0.157373  ,  0.18279641,  0.2054599 ,  0.22332391,  0.20414523,
         0.22405118,  0.23488804,  0.20973917,  0.21492564,  0.23447028,
         0.2514651 ,  0.23495546,  0.20981465,  0.18422025,  0.15230409,
         0.095061  ,  0.08121974,  0.08202497,  0.10280093,  0.11014508,
         0.12962686,  0.1434295 ,  0.15646782,  0.14818742,  0.22067213,
         0.29009443,  0.32528091,  0.35707938,  0.37422718,  0.36490784,
         0.42551778,  0.4779973 ,  0.53904308,  0.60396893,  0.63091485]),
 np.array([-8.94468707e-01, -8.44300152e-01, -7.12463481e-01, -5.85714530e-01,
        -5.73907387e-01, -5.46440146e-01, -5.12729631e-01, -4.77560234e-01,
        -4.15364554e-01, -3.59215226e-01, -2.71808673e-01, -1.06445738e-02,
         5.87334035e-02,  1.03846394e-01,  1.05845524e-01,  2.68746470e-02,
         1.93342318e-02,  4.01985137e-02,  5.06917749e-02,  6.80067561e-02,
         8.94214075e-02,  8.24120380e-02,  8.17321373e-02,  8.68099432e-02,
         7.96861488e-02,  7.26046105e-02,  6.56521245e-02,  6.74256092e-02,
         7.32072372e-02,  6.96227610e-02,  8.36566361e-02,  8.51594244e-02,
         9.71175323e-02,  1.10660271e-01,  1.17977941e-01,  1.08550133e-01,
         9.88105302e-02,  1.00273458e-01,  7.01768857e-02,  2.67570978e-02,
         2.28028970e-02,  7.45114505e-03, -1.11964047e-02, -2.14193395e-02,
        -3.93150674e-02, -2.61110363e-02, -1.29114125e-02,  3.76487562e-05,
        -2.12462767e-03, -9.18963628e-03, -2.01578244e-02, -4.71075178e-02,
        -3.66615583e-02, -3.95023315e-02, -1.05135447e-02,  4.84730438e-03,
        -4.61302470e-03,  7.23600719e-02,  1.35456937e-01,  1.87243557e-01,
         2.31896091e-01,  2.91301933e-01,  3.32963257e-01,  3.77781990e-01]),
 np.array([-0.08628143, -0.0192241 ,  0.08412279,  0.17432648,  0.19781583,
         0.2002167 ,  0.18640753,  0.17883157,  0.18383878,  0.15281315,
         0.10476253,  0.07802504,  0.06403143,  0.01917161,  0.00821946,
        -0.00559899, -0.02699796, -0.05274775, -0.09451035, -0.11594449,
        -0.13968196, -0.14931514, -0.14993506, -0.16551546, -0.17782584,
        -0.16923824, -0.16659441, -0.15067986, -0.13694463, -0.1279984 ,
        -0.12870646, -0.1135982 , -0.08897374, -0.07567299, -0.0893663 ,
        -0.11181981, -0.13544452, -0.09903439, -0.08474584, -0.07412907,
        -0.07072126, -0.0638035 , -0.06065685, -0.02598754, -0.02700011,
        -0.03391431, -0.02587282,  0.13422787,  0.17004722,  0.20964011,
         0.2110908 ,  0.21645074,  0.23294491,  0.21472575,  0.19512245,
         0.25977243,  0.33149658,  0.39707948,  0.45500586]),
 np.array([ 0.37968318,  0.42009918,  0.40906631,  0.3867146 ,  0.36258939,
         0.33089469,  0.29640483,  0.29136186,  0.28011108,  0.26733158,
         0.26361164,  0.25358909,  0.25453118,  0.25502905,  0.26315822,
         0.27158803,  0.26769301,  0.26302293,  0.25126826,  0.27227032,
         0.26150295,  0.25049406,  0.24302902,  0.22937272,  0.21378617,
         0.19694919,  0.1787786 ,  0.16033895,  0.14199308,  0.13040155,
         0.11517247,  0.10383401,  0.08954328,  0.07999947,  0.06993051,
         0.05218439,  0.03456213,  0.01232784, -0.00406968, -0.01279903,
        -0.02061254, -0.02919617, -0.06532527, -0.07912661, -0.09481254,
        -0.13037836, -0.15944571, -0.16565732, -0.16839268, -0.1729494 ,
        -0.16384347, -0.16598309, -0.16790712, -0.16687946, -0.17036776,
        -0.17799727, -0.184011  , -0.1924064 , -0.18163707, -0.15178566,
        -0.15996273, -0.19109435, -0.19726213, -0.48822912, -0.50095215,
        -0.51801552, -0.53076564, -0.53962884, -0.54778544, -0.55606938,
        -0.5567119 , -0.56144288, -0.56475395, -0.5786051 , -0.58454878,
        -0.59379475, -0.59468265, -0.59627874, -0.5881757 , -0.57885015,
        -0.56911108, -0.56498424, -0.56223616, -0.55928808, -0.56456055,
        -0.56894641, -0.56155382, -0.5548899 , -0.5551227 , -0.55616818,
        -0.57363691, -0.5678149 , -0.54879464, -0.05593094,  0.0009676 ,
         0.05025273,  0.09761032,  0.14232618,  0.18437614,  0.21207232,
         0.25375134,  0.29381231,  0.33078274,  0.36825916,  0.39870613,
         0.43249422,  0.46500964,  0.49353984,  0.51757941,  0.54730352,
         0.57953195,  0.61189342,  0.64695983,  0.67563096,  0.7049301 ,
         0.73779327,  0.75015804]),
 np.array([ 0.27204837,  0.21300693,  0.2154306 ,  0.22643367,  0.2577804 ,
         0.27688368,  0.287228  ,  0.30239844,  0.33478754,  0.34985846,
         0.36907211,  0.37610625,  0.3833493 ,  0.36970568,  0.35433184,
         0.34366412,  0.3243402 ,  0.31819414,  0.27871139,  0.22378683,
         0.19956308,  0.17143603,  0.13698123,  0.12575375,  0.09491466,
         0.0777334 ,  0.07183406,  0.06127311,  0.03869583,  0.02337051,
         0.00675212,  0.01481049, -0.0384978 , -0.07692146, -0.13118213,
        -0.13931682, -0.14485742, -0.13699525, -0.14100616, -0.14686328,
        -0.29087892, -0.31713985, -0.32990907, -0.3497935 , -0.38010658,
        -0.40173336, -0.41197075, -0.42480759, -0.4231654 , -0.43720577,
        -0.45163416, -0.45086545, -0.45973841, -0.45153547, -0.44990676,
        -0.45286574, -0.4274982 , -0.22050243, -0.19649213, -0.17980909,
        -0.1642652 , -0.14218989, -0.13066199, -0.12799945, -0.13872294,
        -0.11118838, -0.09025048, -0.07317042, -0.07559299, -0.08460329,
        -0.09413222, -0.11180704, -0.15520412, -0.20954512, -0.1439277 ,
        -0.09632762, -0.04738169]),
 np.array([ 0.64307557,  0.73689374,  0.82106382,  0.80968233,  0.73110333,
         0.6678109 ,  0.60255752,  0.52994491,  0.43051947,  0.41004178,
         0.37970009,  0.34640212,  0.30403366,  0.22334677,  0.23569315,
         0.24518476,  0.23631375,  0.22307613,  0.20439252,  0.1832712 ,
         0.1621563 ,  0.13130217,  0.09283627,  0.07971357,  0.06806084,
         0.0461459 ,  0.03900321,  0.0303959 ,  0.03965388,  0.03287063,
         0.0185333 ,  0.00550228, -0.00158708, -0.01361998, -0.04923856,
        -0.09996046, -0.11603893, -0.1600208 , -0.19689945, -0.23453759,
        -0.26447112, -0.29098044, -0.32294914, -0.34024788, -0.35211701,
        -0.38560148, -0.38761784, -0.45082131, -0.44982265, -0.63994833]),
 np.array([-0.14959525, -0.18717939, -0.20122817, -0.20375985, -0.1957956 ,
        -0.20442219, -0.20069819, -0.19761721, -0.18941912, -0.17652297,
        -0.18347461, -0.1742479 , -0.14830931, -0.1456469 , -0.15745617,
        -0.19624816, -0.21969601, -0.22881616, -0.23528959, -0.2429012 ,
        -0.25210778, -0.25481617, -0.26283056, -0.26880117, -0.27175895,
        -0.2745635 , -0.27605814, -0.28035721, -0.28142459, -0.28358714,
        -0.29412792, -0.30575145, -0.31390012, -0.36865424, -0.37175039,
        -0.37733298, -0.37216977, -0.36574241, -0.34707368, -0.32765483,
        -0.31015012, -0.30332107, -0.29234435, -0.27961549, -0.26089921,
        -0.23888568, -0.24270939, -0.24245563, -0.25059359, -0.25060554,
        -0.24804148, -0.24098208, -0.2306055 , -0.21650247, -0.20076277,
        -0.18149574, -0.15402347, -0.13189842, -0.10513106,  0.10697237,
         0.15291465,  0.18487009,  0.21217982,  0.23845535,  0.26188241,
         0.27902554,  0.30423873,  0.31876492,  0.32261923,  0.33176161,
         0.3443443 ,  0.3534408 ,  0.36472829,  0.37131075,  0.37262672,
         0.38223067,  0.37940374,  0.3742198 ,  0.37409399,  0.36852657,
         0.36929795,  0.36623813,  0.36027822,  0.35325141,  0.34860745,
         0.34373596,  0.27780587,  0.26896383,  0.2817153 ,  0.279058  ,
         0.28252702,  0.28241947,  0.27828372,  0.28055809,  0.28720378,
         0.28674781,  0.28382183,  0.27178707,  0.26205342,  0.23029068,
         0.09141598,  0.09030453,  0.08518773,  0.07443959,  0.06736757,
         0.05869365,  0.04765858,  0.02556657,  0.00332988, -0.01328288,
        -0.03461681, -0.03496305, -0.04292607, -0.04529195, -0.05717576,
        -0.0650897 , -0.10930668, -0.15051251, -0.20885867, -0.26666097,
        -0.32469753])]
bin_edges = [[0.0, 0.5, 1.0],
 [0.0,
  0.02857142857142857,
  0.07142857142857142,
  0.1,
  0.12857142857142856,
  0.15714285714285714,
  0.18571428571428572,
  0.2142857142857143,
  0.24285714285714283,
  0.2714285714285714,
  0.3,
  0.32857142857142857,
  0.35714285714285715,
  0.38571428571428573,
  0.41428571428571426,
  0.44285714285714284,
  0.4714285714285714,
  0.5,
  0.5285714285714285,
  0.5571428571428572,
  0.5857142857142856,
  0.6142857142857143,
  0.6428571428571428,
  0.6714285714285715,
  0.7,
  0.7285714285714286,
  0.7571428571428571,
  0.7857142857142858,
  0.8142857142857143,
  0.8428571428571429,
  0.8714285714285714,
  0.8999999999999999,
  0.9285714285714286,
  0.9571428571428571,
  0.9857142857142858,
  1.0],
 [0.0,
  0.03535353535353538,
  0.08249158249158253,
  0.12794612794612797,
  0.1666666666666667,
  0.17676767676767685,
  0.1885521885521886,
  0.19865319865319866,
  0.2154882154882155,
  0.23232323232323235,
  0.23905723905723905,
  0.24579124579124584,
  0.25084175084175087,
  0.2643097643097643,
  0.2777777777777778,
  0.28451178451178455,
  0.2912457912457913,
  0.3047138047138047,
  0.31986531986531996,
  0.32659932659932667,
  0.3367003367003367,
  0.35690235690235694,
  0.37373737373737376,
  0.38215488215488214,
  0.39057239057239057,
  0.39562289562289565,
  0.398989898989899,
  0.40235690235690236,
  0.4057239057239057,
  0.41414141414141414,
  0.4225589225589226,
  0.42592592592592593,
  0.430976430976431,
  0.4360269360269361,
  0.44107744107744107,
  0.4478114478114478,
  0.45622895622895626,
  0.4646464646464647,
  0.4696969696969697,
  0.4730639730639731,
  0.4797979797979799,
  0.4865319865319866,
  0.48989898989898994,
  0.4932659932659932,
  0.4983164983164983,
  0.505050505050505,
  0.5151515151515151,
  0.5235690235690236,
  0.5269360269360269,
  0.5336700336700337,
  0.5420875420875422,
  0.5505050505050506,
  0.5572390572390573,
  0.5606060606060606,
  0.563973063973064,
  0.5673400673400675,
  0.5707070707070708,
  0.5740740740740742,
  0.5774410774410774,
  0.5841750841750842,
  0.5909090909090909,
  0.595959595959596,
  0.6060606060606061,
  0.6161616161616161,
  0.6212121212121213,
  0.6245791245791246,
  0.6279461279461279,
  0.6363636363636364,
  0.6447811447811447,
  0.6515151515151516,
  0.65993265993266,
  0.6683501683501685,
  0.6750841750841752,
  0.6784511784511784,
  0.6835016835016836,
  0.6885521885521887,
  0.691919191919192,
  0.696969696969697,
  0.7020202020202021,
  0.7053872053872055,
  0.7087542087542088,
  0.7121212121212122,
  0.7222222222222222,
  0.7323232323232323,
  0.7356902356902357,
  0.7424242424242424,
  0.7491582491582491,
  0.7525252525252526,
  0.7558922558922561,
  0.7659932659932661,
  0.7777777777777779,
  0.7878787878787878,
  0.8013468013468014,
  0.8181818181818181,
  0.8299663299663299,
  0.8367003367003367,
  0.8434343434343434,
  0.8468013468013468,
  0.8518518518518519,
  0.856902356902357,
  0.8602693602693603,
  0.898989898989899,
  0.9393939393939394,
  0.9713804713804715,
  1.0],
 [0.0,
  0.023809523809523808,
  0.07142857142857142,
  0.11904761904761904,
  0.16666666666666666,
  0.21428571428571427,
  0.26190476190476186,
  0.30952380952380953,
  0.3571428571428571,
  0.40476190476190477,
  0.45238095238095233,
  0.5,
  0.5476190476190477,
  0.5952380952380952,
  0.6428571428571428,
  0.6904761904761905,
  0.7380952380952381,
  0.8095238095238095,
  0.8809523809523809,
  0.9285714285714286,
  0.9761904761904762,
  1.0],
 [0.0,
  0.009433962264150908,
  0.02830188679245281,
  0.04245283018867926,
  0.04952830188679248,
  0.0566037735849057,
  0.07311320754716984,
  0.09198113207547173,
  0.10377358490566041,
  0.11792452830188677,
  0.12971698113207547,
  0.14150943396226412,
  0.16037735849056603,
  0.17452830188679247,
  0.18160377358490562,
  0.18867924528301883,
  0.19575471698113206,
  0.20283018867924518,
  0.21226415094339618,
  0.22405660377358488,
  0.23584905660377353,
  0.24292452830188688,
  0.24764150943396224,
  0.2523584905660376,
  0.25943396226415094,
  0.2688679245283018,
  0.27594339622641495,
  0.2806603773584905,
  0.28773584905660377,
  0.29481132075471694,
  0.2995283018867923,
  0.30660377358490565,
  0.31367924528301894,
  0.3231132075471699,
  0.33254716981132076,
  0.3396226415094339,
  0.346698113207547,
  0.35377358490566035,
  0.36084905660377364,
  0.37264150943396235,
  0.38915094339622636,
  0.40094339622641506,
  0.40801886792452835,
  0.4150943396226415,
  0.4221698113207546,
  0.4268867924528302,
  0.4316037735849057,
  0.43632075471698106,
  0.4410377358490564,
  0.45047169811320753,
  0.46226415094339623,
  0.4716981132075471,
  0.4787735849056604,
  0.48349056603773577,
  0.4882075471698112,
  0.4952830188679245,
  0.5023584905660378,
  0.5094339622641508,
  0.516509433962264,
  0.5283018867924527,
  0.5424528301886792,
  0.5518867924528301,
  0.5589622641509432,
  0.5636792452830187,
  0.570754716981132,
  0.5778301886792452,
  0.5825471698113206,
  0.5919811320754716,
  0.6014150943396226,
  0.6061320754716979,
  0.6108490566037734,
  0.615566037735849,
  0.6202830188679246,
  0.6297169811320755,
  0.6438679245283017,
  0.6556603773584904,
  0.6627358490566038,
  0.6863207547169812,
  0.7122641509433962,
  0.7193396226415094,
  0.731132075471698,
  0.7523584905660378,
  0.7712264150943395,
  0.8891509433962264,
  1.0],
 [0.0,
  0.018518518518518535,
  0.05555555555555561,
  0.09259259259259259,
  0.12962962962962957,
  0.16666666666666663,
  0.20370370370370372,
  0.24074074074074076,
  0.2777777777777778,
  0.31481481481481477,
  0.37037037037037035,
  0.42592592592592593,
  0.4629629629629629,
  0.49999999999999994,
  0.537037037037037,
  0.574074074074074,
  0.6111111111111112,
  0.6481481481481481,
  0.6851851851851851,
  0.7222222222222221,
  0.7592592592592591,
  0.7962962962962963,
  0.8518518518518519,
  0.9444444444444444,
  1.0],
 [0.0,
  0.12214983713355054,
  0.245928338762215,
  0.252442996742671,
  0.26058631921824105,
  0.26547231270358307,
  0.2752442996742671,
  0.28501628664495116,
  0.2915309446254072,
  0.31107491856677527,
  0.32736156351791534,
  0.33061889250814325,
  0.3355048859934854,
  0.3420195439739414,
  0.35016286644951145,
  0.35667752442996753,
  0.3599348534201955,
  0.3631921824104234,
  0.36970684039087953,
  0.37622149837133556,
  0.37947882736156346,
  0.3827361563517916,
  0.3859934853420196,
  0.39250814332247563,
  0.4022801302931597,
  0.4087947882736157,
  0.4120521172638436,
  0.4153094462540716,
  0.41856677524429975,
  0.42182410423452776,
  0.4250814332247558,
  0.4283387622149837,
  0.4381107491856677,
  0.44951140065146583,
  0.4543973941368079,
  0.45765472312703587,
  0.46254071661237783,
  0.46742671009771997,
  0.470684039087948,
  0.47557003257329,
  0.482084690553746,
  0.48697068403908805,
  0.49022801302931596,
  0.496742671009772,
  0.504885993485342,
  0.509771986970684,
  0.5130293159609121,
  0.5179153094462541,
  0.5228013029315961,
  0.5260586319218241,
  0.5293159609120521,
  0.5325732899022801,
  0.5358306188925083,
  0.5390879478827362,
  0.5423452768729642,
  0.5472312703583062,
  0.5537459283387622,
  0.5586319218241043,
  0.5635179153094463,
  0.5684039087947883,
  0.5732899022801303,
  0.5798045602605864,
  0.5846905537459284,
  0.5879478827361564,
  0.5912052117263844,
  0.5960912052117264,
  0.6009771986970684,
  0.6042345276872965,
  0.6074918566775244,
  0.6140065146579805,
  0.6205211726384365,
  0.6270358306188926,
  0.6368078175895766,
  0.6433224755700326,
  0.6482084690553747,
  0.6547231270358307,
  0.6612377850162867,
  0.6677524429967427,
  0.6758957654723128,
  0.6840390879478828,
  0.6921824104234529,
  0.7003257328990229,
  0.7052117263843648,
  0.7100977198697069,
  0.723127035830619,
  0.7394136807817591,
  0.7475570032573291,
  0.7524429967426711,
  0.7589576547231272,
  0.7638436482084692,
  0.7703583061889252,
  0.780130293159609,
  0.8159609120521173,
  0.8811074918566776,
  0.9576547231270358,
  1.0],
 [0.0,
  0.019959058341862845,
  0.052200614124872056,
  0.07011258955987718,
  0.07881269191402251,
  0.0849539406345957,
  0.09058341862845445,
  0.09518935516888434,
  0.10030706243602866,
  0.10440122824974411,
  0.109007164790174,
  0.1156601842374616,
  0.11975435005117707,
  0.12128966223132037,
  0.13510747185261002,
  0.1489252814738997,
  0.150460593654043,
  0.1571136131013306,
  0.16530194472876153,
  0.16888433981576254,
  0.1734902763561924,
  0.17758444216990787,
  0.18014329580348004,
  0.1827021494370522,
  0.18526100307062437,
  0.18935516888433981,
  0.19242579324462641,
  0.19498464687819855,
  0.2016376663254862,
  0.20726714431934493,
  0.2082906857727738,
  0.20931422722620266,
  0.21238485158648926,
  0.21699078812691913,
  0.22006141248720573,
  0.22210849539406347,
  0.22364380757420677,
  0.22671443193449337,
  0.2308085977482088,
  0.23285568065506654,
  0.2343909928352098,
  0.23643807574206754,
  0.24104401228249744,
  0.24872057318321392,
  0.2548618219037871,
  0.2579324462640737,
  0.259467758444217,
  0.2610030706243603,
  0.27482088024565,
  0.2881269191402252,
  0.30194472876151485,
  0.33316274309109517,
  0.3526100307062436,
  0.3602865916069601,
  0.3669396110542477,
  0.3679631525076766,
  0.37052200614124875,
  0.37461617195496416,
  0.3812691914022518,
  0.38792221084953943,
  0.39252814738996933,
  0.3971340839303992,
  0.4094165813715456,
  0.4273285568065507,
  0.44012282497441146,
  0.45291709314227224,
  0.46366427840327534,
  0.47082906857727735,
  0.4953940634595701,
  0.5199590583418628,
  0.5250767656090072,
  0.5317297850562948,
  0.5383828045035824,
  0.5465711361310133,
  0.559365404298874,
  0.5665301944728762,
  0.5742067553735926,
  0.5834186284544524,
  0.5870010235414533,
  0.5905834186284544,
  0.5957011258955988,
  0.6003070624360287,
  0.617195496417605,
  0.6325486182190379,
  0.6356192425793245,
  0.638689866939611,
  0.6412487205731832,
  0.6438075742067554,
  0.6453428863868986,
  0.6494370522006141,
  0.6581371545547594,
  0.6668372569089047,
  0.6709314227226202,
  0.6724667349027635,
  0.6745138178096213,
  0.6791197543500511,
  0.6832139201637666,
  0.6888433981576254,
  0.702661207778915,
  0.7272262026612077,
  0.7436028659160696,
  0.7487205731832138,
  0.754861821903787,
  0.7574206755373593,
  0.7610030706243602,
  0.7656090071647902,
  0.7717502558853634,
  0.7773797338792221,
  0.7814738996929376,
  0.7850562947799385,
  0.7881269191402251,
  0.7922210849539406,
  0.7958034800409417,
  0.8009211873080859,
  0.8055271238485159,
  0.8075742067553736,
  0.8142272262026613,
  0.8208802456499489,
  0.823439099283521,
  0.8387922210849539,
  0.8567041965199591,
  0.8705220061412486,
  0.883828045035824,
  0.9037871033776868,
  0.920675537359263,
  0.9595701125895599,
  0.9989764585465711,
  1.0],
 [0.0,
  0.023809523809523808,
  0.07142857142857142,
  0.10714285714285714,
  0.13095238095238093,
  0.15476190476190477,
  0.17857142857142855,
  0.20238095238095238,
  0.22619047619047616,
  0.25,
  0.27380952380952384,
  0.2976190476190476,
  0.3214285714285714,
  0.34523809523809523,
  0.36904761904761907,
  0.39285714285714285,
  0.41666666666666663,
  0.44047619047619047,
  0.4642857142857143,
  0.5,
  0.5357142857142858,
  0.5595238095238095,
  0.5833333333333333,
  0.6071428571428572,
  0.6309523809523809,
  0.6547619047619048,
  0.6785714285714286,
  0.7023809523809523,
  0.7261904761904763,
  0.75,
  0.7738095238095237,
  0.7976190476190477,
  0.8571428571428572,
  0.9166666666666667,
  0.9642857142857143,
  1.0],
 [0.0,
  0.017241379310344827,
  0.04310344827586207,
  0.07758620689655173,
  0.12068965517241378,
  0.14655172413793105,
  0.16379310344827586,
  0.1810344827586207,
  0.19827586206896552,
  0.21551724137931033,
  0.2327586206896552,
  0.25,
  0.26724137931034486,
  0.2844827586206896,
  0.3017241379310345,
  0.31896551724137934,
  0.33620689655172414,
  0.35344827586206895,
  0.3706896551724138,
  0.3879310344827586,
  0.4051724137931034,
  0.4224137931034483,
  0.4396551724137931,
  0.4568965517241379,
  0.47413793103448276,
  0.4913793103448276,
  0.5086206896551724,
  0.5258620689655172,
  0.5431034482758621,
  0.5689655172413792,
  0.603448275862069,
  0.6293103448275863,
  0.646551724137931,
  0.6637931034482758,
  0.6810344827586208,
  0.6982758620689655,
  0.7155172413793103,
  0.75,
  0.7844827586206897,
  0.8275862068965517,
  0.9310344827586207,
  1.0],
 [0.0,
  0.04081632653061224,
  0.10204081632653061,
  0.14285714285714285,
  0.17346938775510204,
  0.19387755102040816,
  0.2142857142857143,
  0.2346938775510204,
  0.25510204081632654,
  0.2755102040816326,
  0.29591836734693877,
  0.3163265306122449,
  0.336734693877551,
  0.35714285714285715,
  0.37755102040816324,
  0.3979591836734694,
  0.41836734693877553,
  0.4387755102040816,
  0.45918367346938777,
  0.47959183673469385,
  0.5102040816326531,
  0.5408163265306123,
  0.5612244897959183,
  0.5816326530612245,
  0.6020408163265306,
  0.6224489795918368,
  0.6428571428571428,
  0.6632653061224489,
  0.6836734693877551,
  0.7142857142857143,
  0.7551020408163265,
  0.7857142857142857,
  0.8061224489795918,
  0.8571428571428572,
  0.9489795918367347,
  1.0],
 [0.0,
  0.010638297872340425,
  0.0425531914893617,
  0.0851063829787234,
  0.1276595744680851,
  0.1595744680851064,
  0.19148936170212766,
  0.22340425531914893,
  0.24468085106382978,
  0.26595744680851063,
  0.2872340425531915,
  0.30851063829787234,
  0.32978723404255317,
  0.35106382978723405,
  0.37234042553191493,
  0.3936170212765957,
  0.4148936170212766,
  0.4308510638297872,
  0.44148936170212766,
  0.4574468085106383,
  0.4787234042553191,
  0.5,
  0.5212765957446808,
  0.5425531914893618,
  0.5638297872340425,
  0.5851063829787234,
  0.6063829787234043,
  0.6276595744680851,
  0.648936170212766,
  0.6702127659574468,
  0.6914893617021276,
  0.7127659574468086,
  0.7340425531914894,
  0.7872340425531914,
  0.8404255319148937,
  0.8617021276595744,
  0.9361702127659575,
  1.0],
 [0.0,
  0.011921458625525983,
  0.0390369331463301,
  0.0546984572230014,
  0.07152875175315565,
  0.08929406264609631,
  0.09350163627863486,
  0.09887798036465639,
  0.11220196353436186,
  0.12622720897615705,
  0.13370733987844785,
  0.13955119214586253,
  0.14586255259467037,
  0.15217391304347822,
  0.1619915848527349,
  0.17367928938756427,
  0.18326320710612434,
  0.19308087891538106,
  0.19915848527349228,
  0.2052360916316035,
  0.20991117344553528,
  0.2131837307152875,
  0.2218326320710612,
  0.23281907433380086,
  0.24193548387096778,
  0.24824684431977562,
  0.2522206638616176,
  0.25549322113136985,
  0.26040205703599817,
  0.2650771388499299,
  0.26905095839177184,
  0.27232351566152413,
  0.2791023842917251,
  0.2877512856474988,
  0.2980364656381487,
  0.30645161290322576,
  0.3071528751753156,
  0.310892940626461,
  0.31463300607760636,
  0.31720430107526887,
  0.3211781206171108,
  0.32328190743338014,
  0.32538569424964936,
  0.3293595137914913,
  0.33543712014960264,
  0.34011220196353437,
  0.3436185133239832,
  0.3485273492286115,
  0.35203366058906027,
  0.3546049555867227,
  0.35647498831229546,
  0.3588125292192613,
  0.36091631603553065,
  0.36372136512388975,
  0.3674614305750351,
  0.3695652173913044,
  0.37073398784478734,
  0.37143525011687706,
  0.37353903693314633,
  0.3758765778401122,
  0.37821411874707805,
  0.3803179055633473,
  0.3814866760168303,
  0.3833567087424029,
  0.3847592332865825,
  0.3861617578307621,
  0.3882655446470314,
  0.3896680691912109,
  0.3915381019167835,
  0.39364188873305284,
  0.3943431510051426,
  0.396914446002805,
  0.40135577372604014,
  0.40369331463300606,
  0.40532959326788215,
  0.41000467508181393,
  0.41467975689574565,
  0.4165497896213184,
  0.41748480598410476,
  0.4228611500701262,
  0.4329125759700795,
  0.4410939691444601,
  0.44436652641421226,
  0.4457690509583918,
  0.4492753623188406,
  0.4537166900420757,
  0.45675549322113135,
  0.4640018700327255,
  0.47171575502571295,
  0.4822346891070594,
  0.4941561477325853,
  0.4992987377279102,
  0.5030388031790556,
  0.5063113604488079,
  0.5109864422627397,
  0.5203366058906032,
  0.5285179990649838,
  0.531790556334736,
  0.5362318840579711,
  0.541841982234689,
  0.5483870967741935,
  0.5561009817671809,
  0.5642823749415615,
  0.5708274894810659,
  0.573632538569425,
  0.5755025712949977,
  0.5776063581112669,
  0.584852734922861,
  0.5953716690042075,
  0.6033193080878916,
  0.6079943899018234,
  0.6119682094436654,
  0.6154745208041141,
  0.6243571762505844,
  0.6379149135109864,
  0.6442262739597944,
  0.6479663394109398,
  0.654043945769051,
  0.6666666666666667,
  0.6799906498363721,
  0.6848994857410005,
  0.7054698457223003,
  0.7323515661524078,
  0.7433380084151473,
  0.7568957456755494,
  0.7720897615708275,
  0.781439925198691,
  0.7961664329125759,
  0.8101916783543712,
  0.8522674146797569,
  0.8959794296400186,
  0.9282374941561478,
  0.9780271154745208,
  1.0],
 [0.0,
  0.01470588235294118,
  0.03203781512605043,
  0.03781512605042017,
  0.044117647058823525,
  0.0546218487394958,
  0.06722689075630253,
  0.07668067226890757,
  0.08245798319327731,
  0.08823529411764705,
  0.09296218487394958,
  0.09873949579831934,
  0.10556722689075632,
  0.10871848739495799,
  0.11397058823529413,
  0.11817226890756302,
  0.1218487394957983,
  0.12815126050420167,
  0.13865546218487396,
  0.1559873949579832,
  0.16649159663865545,
  0.1722689075630252,
  0.17857142857142855,
  0.18014705882352944,
  0.1832983193277311,
  0.18802521008403364,
  0.19432773109243698,
  0.20115546218487393,
  0.20640756302521007,
  0.21323529411764708,
  0.21796218487394958,
  0.21901260504201678,
  0.2232142857142857,
  0.22846638655462184,
  0.23109243697478993,
  0.23319327731092437,
  0.23581932773109243,
  0.24317226890756305,
  0.25,
  0.26155462184873945,
  0.2773109243697479,
  0.28728991596638653,
  0.29779411764705876,
  0.3067226890756303,
  0.3119747899159664,
  0.31880252100840334,
  0.32405462184873945,
  0.3256302521008403,
  0.328781512605042,
  0.3314075630252101,
  0.3335084033613445,
  0.3371848739495798,
  0.3403361344537815,
  0.34243697478991597,
  0.34506302521008403,
  0.35136554621848737,
  0.3581932773109243,
  0.36344537815126043,
  0.368172268907563,
  0.37027310924369744,
  0.37184873949579833,
  0.37342436974789917,
  0.384453781512605,
  0.39653361344537813,
  0.40336134453781514,
  0.40913865546218486,
  0.41281512605042014,
  0.41754201680672265,
  0.4196428571428571,
  0.4285714285714286,
  0.4543067226890756,
  0.4721638655462185,
  0.4732142857142857,
  0.47584033613445376,
  0.4784663865546218,
  0.483718487394958,
  0.49054621848739494,
  0.5031512605042017,
  0.5147058823529411,
  0.5252100840336134,
  0.5399159663865546,
  0.5467436974789915,
  0.5498949579831932,
  0.5567226890756303,
  0.5798319327731092,
  0.5982142857142856,
  0.6013655462184873,
  0.6108193277310924,
  0.618172268907563,
  0.6260504201680672,
  0.6365546218487395,
  0.6418067226890756,
  0.6633403361344539,
  0.6832983193277311,
  0.7022058823529413,
  0.7221638655462186,
  0.7305672268907564,
  0.7542016806722689,
  0.8151260504201681,
  0.8650210084033614,
  0.8739495798319328,
  0.8886554621848739,
  0.9065126050420169,
  0.9233193277310925,
  0.944327731092437,
  0.9774159663865547,
  1.0],
 [0.0,
  0.011578305911029863,
  0.02620353443022548,
  0.02985984156002438,
  0.03351614868982328,
  0.041438147471054246,
  0.0469226081657526,
  0.04996953077391835,
  0.0542352224253504,
  0.05850091407678245,
  0.06642291285801341,
  0.0725167580743449,
  0.07678244972577697,
  0.08287629494210846,
  0.08653260207190738,
  0.09262644728823888,
  0.09932967702620354,
  0.10420475319926875,
  0.1084704448507008,
  0.11151736745886656,
  0.11395490554539914,
  0.1182205971968312,
  0.12309567336989641,
  0.12553321145642898,
  0.12736136502132844,
  0.13467397928092628,
  0.14381474710542352,
  0.14686166971358927,
  0.14868982327848873,
  0.1541742839731871,
  0.15904936014625232,
  0.16331505179768435,
  0.1687995124923827,
  0.17550274223034737,
  0.18098720292504572,
  0.182205971968312,
  0.1846435100548446,
  0.1876904326630104,
  0.194393662400975,
  0.20109689213893966,
  0.2035344302254723,
  0.20597196831200487,
  0.20840950639853748,
  0.21389396709323583,
  0.21876904326630103,
  0.21998781230956738,
  0.2218159658744668,
  0.2242535039609994,
  0.22851919561243145,
  0.23339427178549665,
  0.23583180987202926,
  0.23826934795856186,
  0.24192565508836075,
  0.24619134673979282,
  0.25045703839122485,
  0.25411334552102377,
  0.2620353443022547,
  0.26934795856185256,
  0.2742230347349177,
  0.279098110907983,
  0.2906764168190128,
  0.3028641072516758,
  0.3101767215112736,
  0.31748933577087146,
  0.32419256550883613,
  0.33150517976843386,
  0.3375990249847654,
  0.34131627056672764,
  0.3449725776965265,
  0.3491773308957953,
  0.35161486898232786,
  0.35588056063375995,
  0.3589274832419257,
  0.3607556368068251,
  0.36380255941499084,
  0.36806825106642294,
  0.37172455819622185,
  0.3735527117611213,
  0.38208409506398544,
  0.39609993906154783,
  0.4064594759293114,
  0.41194393662400974,
  0.4369287020109689,
  0.46191346739792805,
  0.46617915904936014,
  0.4783668494820232,
  0.517976843388178,
  0.5716026812918953,
  0.5959780621572213,
  0.599024984765387,
  0.6020719073735528,
  0.6063375990249847,
  0.6154783668494821,
  0.6337599024984766,
  0.6465569774527727,
  0.6587446678854357,
  0.7434491163924437,
  0.8452163315051798,
  0.9073735527117612,
  0.9704448507007922,
  1.0],
 [0.0,
  0.003676470588235294,
  0.008823529411764707,
  0.016176470588235296,
  0.025735294117647058,
  0.03676470588235294,
  0.047058823529411764,
  0.05073529411764706,
  0.05514705882352941,
  0.0625,
  0.06985294117647059,
  0.07720588235294118,
  0.08198529411764707,
  0.08419117647058824,
  0.08566176470588235,
  0.09080882352941176,
  0.09705882352941175,
  0.09999999999999999,
  0.10183823529411765,
  0.1025735294117647,
  0.10661764705882353,
  0.11397058823529412,
  0.11875,
  0.12205882352941176,
  0.12830882352941175,
  0.1360294117647059,
  0.14705882352941177,
  0.1547794117647059,
  0.15588235294117647,
  0.15698529411764706,
  0.15955882352941175,
  0.16544117647058826,
  0.1698529411764706,
  0.17095588235294118,
  0.1738970588235294,
  0.17904411764705885,
  0.18272058823529413,
  0.1875,
  0.19852941176470587,
  0.20661764705882352,
  0.21029411764705883,
  0.21433823529411763,
  0.2161764705882353,
  0.2172794117647059,
  0.21838235294117647,
  0.21948529411764706,
  0.2202205882352941,
  0.2227941176470588,
  0.22647058823529412,
  0.22867647058823531,
  0.23014705882352943,
  0.23161764705882354,
  0.2375,
  0.24375,
  0.2474264705882353,
  0.2511029411764706,
  0.25845588235294115,
  0.26727941176470593,
  0.2746323529411765,
  0.2823529411764706,
  0.28602941176470587,
  0.28860294117647056,
  0.2922794117647059,
  0.2977941176470588,
  0.3044117647058823,
  0.30808823529411766,
  0.3161764705882353,
  0.3272058823529412,
  0.3345588235294118,
  0.3492647058823529,
  0.36323529411764705,
  0.37058823529411766,
  0.3761029411764706,
  0.40551470588235294,
  0.4375,
  0.44485294117647056,
  0.4496323529411764,
  0.4606617647058823,
  0.4742647058823529,
  0.49264705882352944,
  0.5220588235294117,
  0.5408088235294117,
  0.5555147058823529,
  0.7830882352941176,
  1.0],
 [0.0,
  0.0043859649122807015,
  0.02631578947368421,
  0.05263157894736842,
  0.0618421052631579,
  0.0706140350877193,
  0.08333333333333333,
  0.09649122807017543,
  0.11403508771929824,
  0.12719298245614036,
  0.13596491228070173,
  0.14473684210526316,
  0.15350877192982454,
  0.16140350877192983,
  0.16578947368421051,
  0.17061403508771927,
  0.175,
  0.17982456140350878,
  0.18859649122807015,
  0.19736842105263158,
  0.20614035087719296,
  0.2149122807017544,
  0.22061403508771926,
  0.2293859649122807,
  0.23728070175438593,
  0.24605263157894736,
  0.25833333333333336,
  0.262719298245614,
  0.2675438596491228,
  0.2763157894736842,
  0.2894736842105263,
  0.2986842105263158,
  0.30745614035087715,
  0.31842105263157894,
  0.32280701754385965,
  0.33333333333333337,
  0.3464912280701754,
  0.35526315789473684,
  0.36403508771929827,
  0.368859649122807,
  0.3776315789473684,
  0.39210526315789473,
  0.40087719298245617,
  0.40789473684210525,
  0.42324561403508776,
  0.4364035087719298,
  0.4473684210526315,
  0.45745614035087717,
  0.46622807017543855,
  0.4780701754385965,
  0.48684210526315785,
  0.4956140350877193,
  0.5030701754385964,
  0.5162280701754386,
  0.5280701754385966,
  0.5324561403508772,
  0.5394736842105263,
  0.5526315789473684,
  0.5657894736842105,
  0.5745614035087719,
  0.6052631578947368,
  0.6491228070175439,
  0.6929824561403508,
  0.7543859649122807,
  0.8157894736842105,
  0.868421052631579,
  0.9035087719298245,
  0.9429824561403508,
  0.986842105263158,
  1.0],
 [0.0,
  0.0022026431718061693,
  0.07158590308370048,
  0.13986784140969166,
  0.1618942731277533,
  0.19273127753303965,
  0.21585903083700442,
  0.23348017621145375,
  0.25550660792951546,
  0.2841409691629956,
  0.3061674008810573,
  0.3270925110132159,
  0.3381057268722467,
  0.3491189427312775,
  0.36013215859030845,
  0.36233480176211463,
  0.37775330396475776,
  0.39757709251101325,
  0.4041850220264317,
  0.40859030837004406,
  0.419603524229075,
  0.4383259911894274,
  0.45374449339207046,
  0.45925110132158586,
  0.4625550660792952,
  0.4669603524229075,
  0.4702643171806168,
  0.47466960352422916,
  0.48237885462555063,
  0.48788546255506615,
  0.49118942731277543,
  0.49779735682819387,
  0.5088105726872247,
  0.5198237885462555,
  0.525330396475771,
  0.5297356828193833,
  0.5341409691629957,
  0.5363436123348019,
  0.5418502202643173,
  0.5506607929515419,
  0.5572687224669604,
  0.5704845814977975,
  0.5837004405286343,
  0.5903083700440529,
  0.5969162995594715,
  0.6123348017621146,
  0.6266519823788547,
  0.6332599118942732,
  0.643171806167401,
  0.6519823788546256,
  0.6585903083700442,
  0.6651982378854626,
  0.6718061674008811,
  0.6751101321585904,
  0.6806167400881058,
  0.6861233480176212,
  0.6894273127753305,
  0.6927312775330398,
  0.6993392070484582,
  0.7059471365638766,
  0.7323788546255507,
  0.7599118942731278,
  0.7632158590308371,
  0.7709251101321587,
  0.7786343612334802,
  0.7907488986784141,
  0.8050660792951543,
  0.8094713656387665,
  0.8138766519823789,
  0.8193832599118943,
  0.8281938325991189,
  0.8381057268722467,
  0.854625550660793,
  0.8788546255506609,
  0.894273127753304,
  0.9019823788546255,
  0.9085903083700442,
  0.9559471365638768,
  1.0],
 [0.0,
  0.033860045146726865,
  0.07900677200902934,
  0.10158013544018056,
  0.1241534988713318,
  0.13769751693002252,
  0.1444695259593679,
  0.15575620767494353,
  0.1715575620767494,
  0.19300225733634307,
  0.21557562076749429,
  0.22799097065462748,
  0.23702031602708795,
  0.24604966139954848,
  0.25959367945823925,
  0.2821670428893905,
  0.3024830699774266,
  0.31376975169300225,
  0.3171557562076749,
  0.3216704288939052,
  0.3318284424379232,
  0.34988713318284415,
  0.36230248306997737,
  0.3656884875846501,
  0.36907449209932275,
  0.3882618510158013,
  0.4085778781038374,
  0.41986455981941306,
  0.4311512415349887,
  0.4424379232505643,
  0.4525959367945823,
  0.45936794582392765,
  0.46952595936794567,
  0.4796839729119638,
  0.48645598194130923,
  0.49209932279909707,
  0.5045146726862302,
  0.5158013544018057,
  0.5237020316027088,
  0.5349887133182845,
  0.5462753950338601,
  0.5530474040632054,
  0.5575620767494356,
  0.5620767494356658,
  0.5665914221218961,
  0.5722347629796838,
  0.5767494356659141,
  0.5790067720090293,
  0.5835214446952595,
  0.5880361173814898,
  0.6060948081264108,
  0.6264108352144468,
  0.6309255079006771,
  0.6343115124153498,
  0.6388261851015801,
  0.6478555304740405,
  0.6557562076749436,
  0.6670428893905191,
  0.6851015801354401,
  0.6963882618510158,
  0.7054176072234764,
  0.7178329571106095,
  0.7279909706546275,
  0.7381489841986455,
  0.7460496613995484,
  0.7528216704288939,
  0.7618510158013544,
  0.7663656884875847,
  0.7776523702031602,
  0.7889390519187358,
  0.793453724604966,
  0.801354401805869,
  0.8092550790067721,
  0.8194130925507901,
  0.8419864559819412,
  0.8690744920993227,
  0.8837471783295712,
  0.9063205417607223,
  0.948081264108352,
  0.9853273137697516,
  1.0],
 [0.0,
  0.0023809523809523833,
  0.011904761904761916,
  0.06190476190476194,
  0.11666666666666672,
  0.14047619047619053,
  0.15476190476190482,
  0.16190476190476197,
  0.17380952380952389,
  0.1833333333333334,
  0.1880952380952382,
  0.19761904761904767,
  0.21190476190476193,
  0.22380952380952385,
  0.23333333333333336,
  0.2404761904761905,
  0.25000000000000006,
  0.26428571428571435,
  0.2761904761904763,
  0.28333333333333344,
  0.2880952380952382,
  0.2928571428571429,
  0.30000000000000016,
  0.30952380952380965,
  0.31666666666666676,
  0.3214285714285715,
  0.3285714285714286,
  0.33571428571428574,
  0.3404761904761905,
  0.3452380952380953,
  0.35476190476190483,
  0.3690476190476191,
  0.37857142857142867,
  0.38809523809523816,
  0.40714285714285725,
  0.42380952380952397,
  0.43333333333333346,
  0.4523809523809525,
  0.47142857142857153,
  0.49523809523809537,
  0.5190476190476192,
  0.5285714285714287,
  0.5523809523809524,
  0.5738095238095239,
  0.5880952380952382,
  0.6190476190476192,
  0.6523809523809525,
  0.6904761904761907,
  0.7380952380952382,
  0.7857142857142858,
  0.8333333333333335,
  0.8809523809523812,
  0.9523809523809526,
  1.0],
 [0.0,
  0.013592233009708741,
  0.03203883495145632,
  0.03980582524271845,
  0.043689320388349516,
  0.04563106796116505,
  0.047572815533980586,
  0.05436893203883496,
  0.0621359223300971,
  0.06504854368932039,
  0.06699029126213593,
  0.0737864077669903,
  0.08058252427184467,
  0.08252427184466021,
  0.08446601941747575,
  0.09223300970873788,
  0.10194174757281554,
  0.10679611650485439,
  0.11067961165048545,
  0.1145631067961165,
  0.11844660194174758,
  0.12233009708737866,
  0.1271844660194175,
  0.13106796116504854,
  0.13398058252427186,
  0.1388349514563107,
  0.14271844660194177,
  0.1533980582524272,
  0.1679611650485437,
  0.1766990291262136,
  0.18155339805825244,
  0.18446601941747576,
  0.19126213592233016,
  0.1980582524271845,
  0.20097087378640777,
  0.20873786407766992,
  0.22038834951456313,
  0.22718446601941752,
  0.23203883495145633,
  0.23689320388349516,
  0.23980582524271848,
  0.2427184466019418,
  0.2456310679611651,
  0.24757281553398058,
  0.25145631067961166,
  0.25533980582524274,
  0.25825242718446606,
  0.2611650485436894,
  0.2631067961165049,
  0.2650485436893204,
  0.2669902912621359,
  0.26990291262135924,
  0.2757281553398058,
  0.28543689320388355,
  0.2951456310679612,
  0.3184466019417477,
  0.350485436893204,
  0.36990291262135927,
  0.37766990291262137,
  0.37961165048543694,
  0.38834951456310685,
  0.40582524271844667,
  0.4165048543689321,
  0.425242718446602,
  0.4339805825242719,
  0.4446601941747574,
  0.4572815533980583,
  0.46116504854368945,
  0.46407766990291266,
  0.47669902912621365,
  0.49029126213592245,
  0.5300970873786408,
  0.5786407766990291,
  0.6194174757281554,
  0.6543689320388351,
  0.6689320388349516,
  0.8388349514563107,
  1.0],
 [0.0,
  0.00992063492063492,
  0.023809523809523794,
  0.02976190476190474,
  0.033730158730158714,
  0.03769841269841269,
  0.04166666666666666,
  0.04563492063492061,
  0.04960317460317458,
  0.05357142857142855,
  0.05753968253968252,
  0.06349206349206347,
  0.06944444444444442,
  0.07341269841269839,
  0.07738095238095236,
  0.08134920634920634,
  0.08730158730158728,
  0.09325396825396823,
  0.09722222222222221,
  0.10317460317460315,
  0.1091269841269841,
  0.11309523809523807,
  0.11706349206349204,
  0.12103174603174602,
  0.12499999999999997,
  0.13095238095238093,
  0.14087301587301582,
  0.14880952380952375,
  0.15277777777777773,
  0.15873015873015872,
  0.16468253968253965,
  0.1686507936507936,
  0.17460317460317457,
  0.1825396825396825,
  0.18849206349206343,
  0.19246031746031744,
  0.19642857142857142,
  0.20039682539682538,
  0.20436507936507933,
  0.2083333333333333,
  0.21230158730158727,
  0.2202380952380952,
  0.2321428571428571,
  0.248015873015873,
  0.26388888888888884,
  0.27182539682539675,
  0.27777777777777773,
  0.2845238095238095,
  0.28849206349206347,
  0.2948412698412698,
  0.30873015873015874,
  0.3194444444444444,
  0.3234126984126984,
  0.32738095238095233,
  0.3313492063492063,
  0.3492063492063492,
  0.367063492063492,
  0.38095238095238093,
  0.3968253968253968,
  0.4087301587301587,
  0.4265873015873015,
  0.4444444444444444,
  0.4722222222222222,
  0.498015873015873,
  0.5079365079365079,
  0.5178571428571428,
  0.5257936507936507,
  0.5376984126984126,
  0.5496031746031745,
  0.5535714285714285,
  0.5773809523809523,
  0.60515873015873,
  0.6289682539682538,
  0.6626984126984126,
  0.6845238095238095,
  0.6924603174603174,
  0.7083333333333333,
  0.7281746031746031,
  0.8154761904761905,
  0.8988095238095237,
  0.9146825396825395,
  0.9464285714285712,
  0.976190476190476,
  0.994047619047619,
  1.0],
 [0.0,
  0.0020000000000000018,
  0.007000000000000006,
  0.01499999999999999,
  0.024999999999999977,
  0.03499999999999999,
  0.045,
  0.05500000000000001,
  0.065,
  0.07499999999999998,
  0.09,
  0.10500000000000001,
  0.11499999999999999,
  0.12499999999999997,
  0.13499999999999998,
  0.145,
  0.155,
  0.16499999999999998,
  0.175,
  0.185,
  0.19499999999999998,
  0.205,
  0.215,
  0.22999999999999998,
  0.24499999999999997,
  0.25999999999999995,
  0.275,
  0.29,
  0.30999999999999994,
  0.32499999999999996,
  0.345,
  0.37,
  0.395,
  0.4149999999999999,
  0.43,
  0.45,
  0.46499999999999997,
  0.475,
  0.49500000000000005,
  0.56,
  0.615,
  0.6250000000000001,
  0.635,
  0.645,
  0.655,
  0.675,
  0.7,
  0.7150000000000001,
  0.7350000000000001,
  0.755,
  0.845,
  0.94,
  0.955,
  0.9650000000000001,
  0.9850000000000001,
  1.0],
 [0.0,
  0.01718750000000005,
  0.045312500000000144,
  0.0625000000000002,
  0.07031250000000017,
  0.07812500000000014,
  0.1015625000000002,
  0.12031250000000021,
  0.12343750000000014,
  0.13750000000000012,
  0.15312500000000007,
  0.15937500000000007,
  0.1734375000000002,
  0.1859375000000002,
  0.19531250000000014,
  0.20468750000000008,
  0.21250000000000005,
  0.22656250000000003,
  0.2359375000000001,
  0.23906250000000018,
  0.24531250000000018,
  0.2546875000000001,
  0.26250000000000007,
  0.26718750000000013,
  0.27031250000000007,
  0.2734375000000001,
  0.2890625000000002,
  0.30468750000000017,
  0.30937500000000007,
  0.31875,
  0.3281250000000001,
  0.3328125000000001,
  0.33906250000000016,
  0.35312500000000013,
  0.36875,
  0.37968750000000007,
  0.38750000000000007,
  0.3984375000000001,
  0.4078125000000002,
  0.4140625000000002,
  0.4203125000000002,
  0.43281250000000004,
  0.45625,
  0.47968750000000004,
  0.4953125000000001,
  0.5046875000000002,
  0.5109375000000003,
  0.5218750000000001,
  0.5328124999999999,
  0.5375000000000001,
  0.5515625000000002,
  0.5656250000000002,
  0.5703125,
  0.578125,
  0.5890625,
  0.609375,
  0.640625,
  0.671875,
  0.7031250000000001,
  0.7656250000000002,
  0.828125,
  0.8593750000000001,
  0.9031250000000002,
  0.9656250000000001,
  1.0],
 [0.0,
  0.005703422053231936,
  0.01520912547528515,
  0.034220532319391615,
  0.05133079847908743,
  0.05513307984790872,
  0.06083650190114068,
  0.06844106463878327,
  0.07984790874524714,
  0.09277566539923951,
  0.09847908745247147,
  0.10076045627376426,
  0.10532319391634978,
  0.10912547528517107,
  0.11787072243346006,
  0.12927756653992395,
  0.13878326996197715,
  0.14638783269961975,
  0.15019011406844102,
  0.155893536121673,
  0.16159695817490494,
  0.17110266159695817,
  0.18441064638783267,
  0.19201520912547526,
  0.19771863117870722,
  0.21102661596958172,
  0.2300380228136882,
  0.24144486692015207,
  0.24904942965779467,
  0.2604562737642585,
  0.26806083650190116,
  0.2718631178707225,
  0.2946768060836502,
  0.3346007604562738,
  0.3612167300380228,
  0.3802281368821293,
  0.41064638783269963,
  0.43346007604562736,
  0.44296577946768056,
  0.4505703422053232,
  0.45437262357414454,
  0.48098859315589354,
  0.5152091254752852,
  0.5342205323193916,
  0.5627376425855513,
  0.6007604562737643,
  0.6349809885931559,
  0.6730038022813688,
  0.7110266159695817,
  0.7300380228136882,
  0.7376425855513309,
  0.7490494296577948,
  0.7832699619771863,
  0.811787072243346,
  0.8365019011406845,
  0.8916349809885932,
  0.9391634980988592,
  0.9752851711026616,
  0.9980988593155893,
  1.0],
 [0.0,
  0.00813073579133795,
  0.016744485590082115,
  0.01754950893575914,
  0.021896635002415073,
  0.027451296087586542,
  0.03067138947029464,
  0.0324424408307841,
  0.03284495250362261,
  0.033569473514731926,
  0.034293994525841254,
  0.0359040412171953,
  0.03799710191595557,
  0.04121719529866366,
  0.04387377233939784,
  0.044678795685074865,
  0.04604733537272581,
  0.05007245210111093,
  0.05812268555788118,
  0.06375784897762035,
  0.06979552407019804,
  0.07760425052326517,
  0.08122685557881179,
  0.08654000966028014,
  0.09217517308001932,
  0.09515375945902431,
  0.09756882949605539,
  0.09998389953308645,
  0.10239896957011753,
  0.10481403960714859,
  0.1080341329898567,
  0.11044920302688777,
  0.11286427306391884,
  0.11769441313798099,
  0.12171952986636611,
  0.12413459990339719,
  0.12614715826758977,
  0.12695218161326677,
  0.12775720495894377,
  0.13339236837868296,
  0.13943004347126065,
  0.1418451135082917,
  0.14506520689099983,
  0.14699726292062468,
  0.1500563516341974,
  0.15536950571566574,
  0.15875060376750924,
  0.15995813878602477,
  0.1607631621317018,
  0.16197069715021734,
  0.16519079053292546,
  0.16921590726131058,
  0.17163097729834165,
  0.1740460473353727,
  0.18290130413782,
  0.19739172436000643,
  0.20544195781677665,
  0.20664949283529221,
  0.21228465625503137,
  0.2199323780389631,
  0.22476251811302528,
  0.2295926581870874,
  0.2328127515697955,
  0.2352278216068266,
  0.24247303171791978,
  0.24971824182901303,
  0.2514087908549348,
  0.25301883754628884,
  0.2547898889067783,
  0.2554339075833199,
  0.25680244727097085,
  0.2593785219771373,
  0.2625986153598454,
  0.26501368539687653,
  0.26662373208823054,
  0.281114152310417,
  0.2972146192239575,
  0.3076799227177588,
  0.3173402028658831,
  0.3348897118016423,
  0.3517952020608598,
  0.3567863468040573,
  0.36564160360650455,
  0.3728868137175978,
  0.37828047013363386,
  0.383110610207696,
  0.3930123973595234,
  0.410722910964418,
  0.42843342456931255,
  0.4380937047174368,
  0.4413137981001449,
  0.44372886813717605,
  0.45097407824826924,
  0.4646594751247787,
  0.4727097085815489,
  0.475929801964257,
  0.48092094670745456,
  0.4841410400901626,
  0.49042022218644343,
  0.49718241829013043,
  0.49959748832716144,
  0.5024955723715987,
  0.5129608758654001,
  0.5234261793592014,
  0.5290613427789406,
  0.5376750925776848,
  0.544115279343101,
  0.5548220898406053,
  0.5765577201738851,
  0.6176139108034133,
  0.6594751247786186,
  0.6852358718402833,
  0.703751408790855,
  0.7319272258895508,
  0.7979391402350668,
  0.9170825953952665,
  0.9959748832716149,
  1.0],
 [0.0,
  0.016666666666666666,
  0.03666666666666667,
  0.042333333333333334,
  0.045,
  0.046,
  0.04733333333333333,
  0.05,
  0.05266666666666667,
  0.05466666666666667,
  0.05666666666666667,
  0.05766666666666667,
  0.059000000000000004,
  0.061000000000000006,
  0.06233333333333334,
  0.06366666666666666,
  0.065,
  0.066,
  0.06866666666666667,
  0.07200000000000001,
  0.07666666666666666,
  0.08233333333333334,
  0.08566666666666667,
  0.09,
  0.096,
  0.09933333333333333,
  0.10300000000000001,
  0.10633333333333334,
  0.11,
  0.11666666666666667,
  0.12333333333333332,
  0.13,
  0.13633333333333333,
  0.13966666666666666,
  0.15000000000000002,
  0.16499999999999998,
  0.17166666666666666,
  0.18,
  0.19033333333333333,
  0.197,
  0.20333333333333334,
  0.20800000000000002,
  0.20966666666666667,
  0.22,
  0.23333333333333334,
  0.24333333333333335,
  0.251,
  0.25666666666666665,
  0.264,
  0.2683333333333333,
  0.275,
  0.2803333333333333,
  0.29033333333333333,
  0.30333333333333334,
  0.3123333333333333,
  0.32099999999999995,
  0.32533333333333336,
  0.33,
  0.33999999999999997,
  0.35,
  0.3566666666666667,
  0.3626666666666667,
  0.37933333333333336,
  0.3966666666666667,
  0.4066666666666667,
  0.41666666666666663,
  0.44,
  0.4633333333333334,
  0.47,
  0.4766666666666667,
  0.49,
  0.5043333333333333,
  0.5276666666666667,
  0.5666666666666667,
  0.5933333333333333,
  0.61,
  0.81,
  1.0],
 [0.0,
  0.01750000000000007,
  0.04250000000000007,
  0.07500000000000001,
  0.10250000000000004,
  0.11500000000000003,
  0.13249999999999992,
  0.1424999999999999,
  0.14749999999999996,
  0.15249999999999986,
  0.1599999999999998,
  0.175,
  0.19000000000000022,
  0.19750000000000015,
  0.21999999999999992,
  0.24499999999999994,
  0.25749999999999995,
  0.275,
  0.2925000000000001,
  0.31000000000000016,
  0.33000000000000007,
  0.3425000000000001,
  0.34750000000000014,
  0.375,
  0.4075,
  0.41999999999999993,
  0.43000000000000005,
  0.4375,
  0.44499999999999995,
  0.475,
  0.5100000000000001,
  0.5350000000000001,
  0.5725000000000002,
  0.5975000000000001,
  0.6074999999999999,
  0.6275,
  0.6425000000000001,
  0.6475000000000002,
  0.655,
  0.6625,
  0.6675,
  0.6825000000000003,
  0.6975000000000001,
  0.7050000000000001,
  0.7300000000000001,
  0.7725000000000002,
  0.7975000000000001,
  0.825,
  0.875,
  0.95,
  1.0],
 [0.0,
  0.0017921146953405018,
  0.026284348864994027,
  0.05017921146953405,
  0.053046594982078865,
  0.06140979689366787,
  0.07646356033452809,
  0.08602150537634409,
  0.08841099163679808,
  0.0991636798088411,
  0.1111111111111111,
  0.1142174432497013,
  0.11541218637992831,
  0.11827956989247312,
  0.12126642771804062,
  0.12425328554360812,
  0.13082437275985664,
  0.13620071684587814,
  0.13751493428912784,
  0.13859020310633213,
  0.14086021505376345,
  0.14336917562724016,
  0.14575866188769415,
  0.15053763440860216,
  0.15651135005973715,
  0.16129032258064518,
  0.16606929510155316,
  0.1875746714456392,
  0.2075268817204301,
  0.2182795698924731,
  0.22867383512544803,
  0.24958183990442054,
  0.27419354838709675,
  0.27956989247311825,
  0.2855436081242533,
  0.2927120669056153,
  0.30107526881720426,
  0.30824372759856633,
  0.3106332138590203,
  0.3201911589008363,
  0.33273596176821985,
  0.3375149342891278,
  0.3416965352449224,
  0.351015531660693,
  0.3597371565113501,
  0.3671445639187575,
  0.3751493428912784,
  0.3799283154121864,
  0.3882915173237754,
  0.4086021505376344,
  0.4227001194743131,
  0.42747909199522105,
  0.4324970131421744,
  0.43727598566308246,
  0.4413381123058542,
  0.44229390681003583,
  0.4442054958183991,
  0.45041816009557945,
  0.4577060931899642,
  0.46367980884109916,
  0.47192353643966545,
  0.4778972520908005,
  0.48028673835125446,
  0.4970131421744325,
  0.5161290322580645,
  0.5209080047789725,
  0.5244922341696535,
  0.5352449223416965,
  0.5448028673835126,
  0.5471923536439665,
  0.5495818399044206,
  0.5519713261648747,
  0.5536439665471924,
  0.5571087216248506,
  0.5626045400238948,
  0.5663082437275986,
  0.5722819593787336,
  0.5806451612903225,
  0.5849462365591398,
  0.5873357228195939,
  0.5937873357228196,
  0.6005973715651135,
  0.6077658303464755,
  0.6140979689366786,
  0.6164874551971327,
  0.6212664277180406,
  0.6249701314217444,
  0.6285543608124253,
  0.6344086021505376,
  0.6391875746714456,
  0.6433691756272402,
  0.6481481481481481,
  0.6523297491039426,
  0.6580645161290323,
  0.6652329749103942,
  0.6738351254480287,
  0.6806451612903226,
  0.6842293906810035,
  0.6881720430107527,
  0.6903225806451613,
  0.6915173237753882,
  0.6929510155316607,
  0.7021624850657109,
  0.7147072879330943,
  0.7198327359617682,
  0.724731182795699,
  0.734289127837515,
  0.7491039426523298,
  0.7707287933094384,
  0.7838709677419355,
  0.8052568697729987,
  0.8291517323775388,
  0.8339307048984468,
  0.8369175627240144,
  0.8412186379928316,
  0.8442054958183991,
  0.8458781362007168,
  0.8542413381123058,
  0.8673835125448028,
  0.8769414575866188,
  0.94026284348865,
  1.0]]

feature_min = np.array([0.000e+00, 2.500e+01, 1.770e+01, 5.000e+00, 2.710e+01, 2.000e+00,
                        3.070e+01, 1.179e+03, 8.900e+01, 7.600e+01, 8.400e+01, 8.600e+01,
                        2.093e+01, 7.100e+00, 9.000e+00, 8.000e+00, 4.200e+01, 3.260e+00,
                        1.300e+00, 7.000e-01, 3.600e-01, 4.400e+00, 1.900e+00, 4.100e+00])

feature_max = np.array([1.000e+00, 6.000e+01, 4.740e+01, 2.600e+01, 4.870e+01, 4.700e+00,
                        6.140e+01, 2.156e+03, 1.320e+02, 1.340e+02, 1.350e+02, 1.340e+02,
                        4.232e+01, 1.237e+02, 1.040e+02, 1.440e+02, 1.560e+02, 7.800e+00,
                        5.900e+00, 2.800e+00, 5.510e+00, 3.140e+01, 1.740e+01, 7.900e+00])

def predict_log_odds(intercept, contributions, feature_values, bin_edges):
    log_odds = intercept
    for i, value in enumerate(feature_values):
        bin_idx = np.digitize(value, bin_edges[i]) - 1
        bin_idx = min(bin_idx, len(contributions[i]) - 1)
        log_odds += contributions[i][bin_idx]
    return log_odds

def predict_probability(log_odds):
    return 1 / (1 + np.exp(-log_odds))

def min_max_scaler(values, feature_min, feature_max):
    scaled_values = (values - feature_min) / (feature_max - feature_min)
    return scaled_values

# Streamlit page setup
st.set_page_config(page_title="Прогноз НАЖБП", page_icon="💉", layout="wide")

st.title("💉 Прогноз НАЖБП")
st.write("Введите значения показателей для получения прогноза вероятности НАЖБП.")

gender = st.radio("**Выберите пол:**", ("Мужской", "Женский"))
gender_value = 0 if gender == "Мужской" else 1

if gender == "Мужской":
    normal_ranges = {
        'Возраст': (0, 100),
        'О.ж.,%': (10, 25),
        'Висц.ж,%': (5, 15),
        'Скелет,%': (30, 40),
        'Кости,кг': (2, 5),
        'Вода,%': (50, 70),
        'СООВ,ккал': (1500, 3500),
        'ОГ,см': (75, 105),
        'ОТ,см': (60, 95),
        'ОЖ,см': (70, 105),
        'ОБ,см': (40, 65),
        'ИМТ': (18.5, 24.9),
        'АЛТ': (7, 41),
        'АСТ': (10, 40),
        'ГГТП': (10, 70),
        'ЩФ': (40, 130),
        'ХСобщ.': (0, 5.2),
        'ЛПНП': (0, 3.0),
        'ЛПВП': (1.0, 1.5),
        'Триглиц.': (0, 1.7),
        'Билир.о': (0, 1.2),
        'Билир.пр': (0, 0.3),
        'Глюкоза': (3.9, 5.5)
    }
else:
    normal_ranges = {
        'Возраст': (0, 100),
        'О.ж.,%': (18, 30),
        'Висц.ж,%': (5, 15),
        'Скелет,%': (25, 35),
        'Кости,кг': (1.5, 4),
        'Вода,%': (50, 60),
        'СООВ,ккал': (1200, 3000),
        'ОГ,см': (75, 100),
        'ОТ,см': (60, 90),
        'ОЖ,см': (70, 100),
        'ОБ,см': (35, 60),
        'ИМТ': (18.5, 24.9),
        'АЛТ': (7, 35),
        'АСТ': (10, 35),
        'ГГТП': (10, 50),
        'ЩФ': (40, 120),
        'ХСобщ.': (0, 5.2),
        'ЛПНП': (0, 3.0),
        'ЛПВП': (1.0, 1.5),
        'Триглиц.': (0, 1.7),
        'Билир.о': (0, 1.2),
        'Билир.пр': (0, 0.3),
        'Глюкоза': (3.9, 5.5)
    }

col1, col2 = st.columns(2)

with col1:
    st.header("**Введите показатели:**")
    age = st.number_input("**Возраст**", min_value=0, max_value=100, value=30)
    total_fat = st.number_input("**О.ж.,%**", min_value=0.0, max_value=100.0, value=20.0)
    vis_fat = st.number_input("**Висц.ж,%**", min_value=0.0, max_value=100.0, value=5.0)
    skeletal_mass = st.number_input("**Скелет,%**", min_value=0.0, max_value=100.0, value=40.0)
    bone_mass = st.number_input("**Кости,кг**", min_value=0.0, max_value=20.0, value=3.0)
    water = st.number_input("**Вода,%**", min_value=0.0, max_value=100.0, value=60.0)
    metabolic_rate = st.number_input("**СООВ,ккал**", min_value=0.0, max_value=5000.0, value=2000.0)
    chest = st.number_input("**ОГ,см**", min_value=0.0, max_value=150.0, value=90.0)
    waist = st.number_input("**ОТ,см**", min_value=0.0, max_value=150.0, value=80.0)
    hip = st.number_input("**ОЖ,см**", min_value=0.0, max_value=150.0, value=100.0)
    thigh = st.number_input("**ОБ,см**", min_value=0.0, max_value=150.0, value=55.0)
    bmi = st.number_input("**ИМТ**", min_value=0.0, max_value=100.0, value=24.0)
    alt = st.number_input("**АЛТ**", min_value=0.0, max_value=200.0, value=30.0)
    ast = st.number_input("**АСТ**", min_value=0.0, max_value=200.0, value=30.0)
    ggtp = st.number_input("**ГГТП**", min_value=0.0, max_value=200.0, value=15.0)

with col2:
    alkaline_phosphatase = st.number_input("**ЩФ**", min_value=0.0, max_value=500.0, value=100.0)
    cholesterol = st.number_input("**ХСобщ.**", min_value=0.0, max_value=500.0, value=200.0)
    ldl = st.number_input("**ЛПНП**", min_value=0.0, max_value=100.0, value=3.0)
    hdl = st.number_input("**ЛПВП**", min_value=0.0, max_value=100.0, value=1.0)
    triglycerides = st.number_input("**Триглиц.**", min_value=0.0, max_value=100.0, value=1.5)
    bilirubin_total = st.number_input("**Билир.о**", min_value=0.0, max_value=10.0, value=1.0)
    bilirubin_direct = st.number_input("**Билир.пр**", min_value=0.0, max_value=100.0, value=0.5)
    glucose = st.number_input("**Глюкоза**", min_value=0.0, max_value=100.0, value=5.0)

    if st.button("Рассчитать Прогноз"):
        input_features = [
            gender_value, age, total_fat, vis_fat, skeletal_mass, bone_mass, 
            water, metabolic_rate, chest, waist, hip, thigh, bmi, alt, ast, 
            ggtp, alkaline_phosphatase, cholesterol, ldl, hdl, triglycerides, 
            bilirubin_total, bilirubin_direct, glucose
        ]

        scaled_features = min_max_scaler(np.array(input_features), np.array(feature_min), np.array(feature_max))
        log_odds = predict_log_odds(intercept, contributions, scaled_features, bin_edges)
        probability = predict_probability(log_odds)

        predicted_class = "Болен" if probability >= 0.5 else "Здоров"

        st.subheader("**Результаты Прогноза:**")
        st.write(f"**Вероятность:** {probability:.4f}")
        st.write(f"**Класс:** {predicted_class}")

        if predicted_class == "Болен":
            st.error("Модель предсказывает, что вы больны.")
        else:
            st.success("Модель предсказывает, что вы здоровы.")
       
        user_values_scaled = min_max_scaler(np.array(input_features[1:]), feature_min[1:], feature_max[1:])
        normal_min_scaled = [0 for _ in feature_min[1:]]
        normal_max_scaled = [1 for _ in feature_max[1:]]
        st.subheader("**📊 Сравнение ваших значений с нормальными диапазонами**")        
        fig, ax = plt.subplots(figsize=(8, 5))
        
        for i, (min_val, max_val) in enumerate(zip(normal_min_scaled, normal_max_scaled)):
            ax.plot([min_val, max_val], [i, i], color='gray', lw=6, alpha=0.5, label='Нормальный диапазон' if i == 0 else "")
        features = ['Возраст', 'О.ж.,%', 'Висц.ж,%', 'Скелет,%', 'Кости,кг', 'Вода,%', 'СООВ,ккал', 'ОГ,см', 
                'ОТ,см', 'ОЖ,см', 'ОБ,см', 'ИМТ', 'АЛТ', 'АСТ', 'ГГТП', 'ЩФ', 'ХСобщ.', 'ЛПНП', 'ЛПВП', 
                'Триглиц.', 'Билир.о', 'Билир.пр', 'Глюкоза']

        normal_min = [normal_ranges[feat][0] for feat in features]
        normal_max = [normal_ranges[feat][1] for feat in features]

        ax.scatter(user_values_scaled, range(len(features)), color='blue', s=100, zorder=5, label='Ваши значения')
        
        ax.set_xlabel('Нормализованные значения (0-1)', fontsize=12, fontweight='bold')
     
        ax.set_yticks(range(len(features)))
        ax.set_yticklabels(features, fontsize=11, fontweight='bold')
        
        for i, feature in enumerate(features):
           actual_range_text = f"Норма: {normal_min[i]} - {normal_max[i]}"
           user_value_text = f"{user_values[i]:.2f}"
           
           ax.annotate(f"Норма: {actual_range_text}", xy=(1.0, i), xycoords='data', 
                       textcoords='offset points', fontsize=10, color='gray', xytext=(10, 0))
           
           ax.annotate(f"Ваше: {user_value_text}", xy=(1.0, i), xycoords='data', 
                       textcoords='offset points', fontsize=10, color='blue', xytext=(50, 0))

        
        ax.spines['right'].set_visible(False)
        ax.spines['top'].set_visible(False)
        ax.spines['left'].set_linewidth(1.5)
        ax.spines['bottom'].set_linewidth(1.5)
        ax.set_xlim([0, 1.5])
        ax.grid(True, axis='x', linestyle='--', alpha=0.6)
        ax.legend(loc='lower right', fontsize=10)
        
        st.pyplot(fig)

st.write("---")
st.write("Это приложение создано для помощи в прогнозе НАЖБП на основе различных показателей.")
st.write("Приложение использует биохимические маркеры, индекс массы тела, и другие параметры.")
st.write("Приложение НЕ создано для самостоятельной постановки диагноза.")
